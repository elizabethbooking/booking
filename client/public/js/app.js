var Booking;Booking=angular.module("Booking",["ui.router","angularUtils.directives.dirPagination"]),Booking.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/home"),e.state("home",{url:"/home",templateUrl:"/templates/views/index.html",controller:"HomeController"}).state("booking",{url:"/booking/:querry",templateUrl:"/templates/booking.html"}).state("reserve",{url:"/reserve/:roomdetails",templateUrl:"/templates/views/reserve.html",controller:"ReserveController"}).state("payment",{url:"/payment",templateUrl:"/templates/views/payment.html",controller:"paymentController"}).state("Confirmation",{url:"/Confirmation",templateUrl:"/templates/views/paymentConfirmation.html",controller:"confirmationController"}).state("thanknote",{url:"/thanknote/:reservationid",templateUrl:"/templates/views/thanknote.html",controller:"thanknoteController"}).state("guestinfo",{url:"/guestinfo",templateUrl:"/templates/views/profile.html",controller:"guestController"})}]);
Booking.factory("CompanyService",["$http",function(n){return{data:function(t){n.get("/api/company").success(function(n,c){t(n)})}}}]);
Booking.factory("CustomerService",["$http",function(t){return{data:function(c){t.get("/api/customer").success(function(t,n){c(t)})}}}]);
Booking.service("DataService",["$http",function(o){var t=[];this.save=function(o){t.push(o),console.log("data Saved"),console.log(t)},this.get=function(){return t}}]);
Booking.factory("InventoryService",["$http",function(t){var n=10001;return{results:[],data:function(n){t.get("/api/inventory").success(function(t,i){n(t)})},query:function(i,s){t.post("/api/availability/"+n,i).success(function(t,n){this.results=t,s(t)}.bind(this))}}}]);
Booking.factory("LoginService",["$http","$rootScope",function(o,e){return{auth:function(e,n){o.post("/api/login",e).success(function(o,e){n(o,e)}).error(function(){console.log("error")})},user:function(){var o="";return $cookies.get("user")&&(e.loggedIn=o=JSON.parse($cookies.get("user"))),o},logout:function(){e.loggedIn=null,$cookies.remove("user")}}}]);
Booking.factory("PoliciesService",["$http",function(i){return{data:function(c){i.get("/api/policies").success(function(i,t){c(i)})}}}]);
Booking.factory("ReservationService",["$http",function(e){var n={};return n.data=function(){return e.get("/api/reservation")},n.query=function(n){return e.get("/api/reservation")},n.create=function(n){return e.post("/api/reservation",n)},n.pendingReservations=function(){return e.get("/admin/PendingReservations")},n}]);
Booking.factory("RoleService",["$http",function(t){return{data:function(n){t.get("/api/role").success(function(t,o){n(t)})}}}]);
Booking.factory("UsersService",["$http",function(t){return{data:function(n){t.get("/api/users").success(function(t,c){n(t)})}}}]);
Booking.directive("availability",["$rootScope","dateFilter",function(e,o){return{restrict:"E",templateUrl:"/templates/directives/availability.html",controller:["$scope","$location","ReservationService","$stateParams","DataService",function(e,o,r,t,s){e.selectedrooms=[],e.number=-1,e.querry=angular.fromJson(atob(t.querry)),e.selectroom=function(o,r){var t={};t.id=o,t.room=r,r.selected=!0,e.selectedrooms.push(t),e.number=o,console.log(e.selectedrooms)},e.removeroom=function(o){for(i in e.selectedrooms)e.selectedrooms[i].id==o&&e.selectedrooms.splice(i,1)},e.book=function(){var r={};r.selectedrooms=e.selectedrooms,r.querry=e.querry,r.companyid=e.selectedrooms[0].room.company_id,r.id="bookinginfo";var t=btoa(angular.toJson(r));s.save(r),o.path("/reserve/"+t)},e.submit=function(){r.query(e.query).success(function(e){}).error(function(e){alert("Errror "+e.message)})}}]}}]);
Booking.directive("footerNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/footer.html",controller:"FooterController"}}]);
Booking.directive("home",[function(){return{restrict:"E",templateUrl:"/templates/home.html"}}]);
Booking.directive("inventory",[function(){return{restrict:"E",templateUrl:"/templates/inventory.html"}}]);
Booking.directive("leftNav",[function(){return{restrict:"A",scope:{},transclude:!0,templateUrl:"/templates/directives/left_nav.html",controller:"LeftNavController"}}]);
Booking.directive("login",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/login.html",controller:"LoginController"}}]);
Booking.directive("policies",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/policies.html",controller:"PoliciesController"}}]);
Booking.directive("query",["$rootScope","dateFilter","$location",function(t,e,o){return{restrict:"E",templateUrl:"/templates/directives/query.html",controller:["$scope","InventoryService",function(e,r){e.max_adults=[1,2,3],e.max_childs=[0,1,2,3],e.query={adults:1,childs:0,check_in:(new moment).toDate(),check_out:(new moment).add(3,"days").toDate()},e.submit=function(){r.query(e.query,function(e){t.$broadcast("query:results")});var n=btoa(angular.toJson(e.query));o.path("/booking/"+n)}}]}}]);
Booking.directive("resNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/res-nav.html",controller:"ResController"}}]);
Booking.directive("topNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/header.html",controller:"HeaderController"}}]);
Booking.directive("users",[function(){return{restrict:"E",templateUrl:"/templates/users.html"}}]);
Booking.directive("user_profile",[function(){return{restrict:"E",templateUrl:"/templates/user_profile.html"}}]);
Booking.controller("confirmationController",["DataService","$location","$scope","ReservationService",function(o,r,n,i){n.formData=o.get(),n.guestinfo=_.findWhere(n.formData,{id:"guestinfo"}).customerProfile,n.cardinfo=_.findWhere(n.formData,{id:"paymentinfo"}).paymentDetails,n.bookinginfo=_.findWhere(n.formData,{id:"bookinginfo"}).selectedrooms,n.guestSummary=_.findWhere(n.formData,{id:"bookinginfo"}).querry,n.roomsSummary=_.findWhere(n.formData,{id:"roominfo"}).summary,n.company_id=_.findWhere(n.formData,{id:"bookinginfo"}).companyid,n.processForm=function(){var o={};o.guestinfo=n.guestinfo,o.cardinfo=n.cardinfo,o.bookinginfo=n.bookinginfo,o.guestSummary=n.guestSummary,o.roomSummary=n.roomsSummary,o.company_id=n.company_id,i.create(o).success(function(o){console.log(o),n.formData="",r.path("/thanknote/"+o.success)}).error(function(o){alert("Errror "+o)})}}]);
Booking.controller("CustomerController",["CustomerService",function(o){this.customer=null,this.data="Booking Customer";var t=this;CustomerService.data(function(o){t.customer=o,console.log(o)})}]);
Booking.controller("FooterController",["$scope",function(o){}]);
Booking.controller("guestController",["DataService","$state","$scope",function(o,t,e){e.formData={},e.payment=function(){var a={};a.id="guestinfo",a.customerProfile=e.formData,o.save(a),t.go("payment")}}]);
Booking.controller("HeaderController",["$scope",function(o){}]);
Booking.controller("HomeController",["CompanyService","ReservationService","$scope",function(o,n,e){this.company=null,this.data="Booking Home";var i=this;o.data(function(o){i.company=o,console.log(o)}),n.pendingReservations().success(function(o){console.log("pending Reservation "),console.log(o.result),e.pendingConfirmation=o.result}).error(function(o){console.log("Error in pending Reservation "),console.log(o),e.pendingConfirmation=[]})}]);
Booking.controller("InventoryController",["$rootScope","InventoryService",function(t,o){this.results=o.results,t.$on("query:results",function(){this.results=o.results}.bind(this))}]);
Booking.controller("LeftNavController",["$scope",function(o){}]);
Booking.controller("LoginController",["$rootScope","$scope","$window","LoginService",function(o,n,e,t){n.submit=function(){t.auth(n.user,function(n,t){200===t?(e.sessionStorage.token=n.token,o.loggedIn=n,e.location.href="/Admin.html"):delete e.sessionStorage.token})}}]);
Booking.controller("LogoutController",["$location","LoginService",function(o,n){n.logout(),o.path("/login")}]);
Booking.controller("paymentController",["DataService","$state","$scope",function(o,t,a){a.formData={},a.gotoConfirm=function(){var n={};n.id="paymentinfo",n.paymentDetails=a.formData,o.save(n),t.go("Confirmation")}}]);
Booking.controller("PoliciesController",["$rootScope","$scope","$location",function(o,i,c){i.policies=function(o){return policies.show=!0}}]);
Booking.controller("ResController",["$scope",function(o){}]);
Booking.controller("ReservationController",["ReservationService",function(o){this.reservation=null,this.data="Booking Rerservation";var e=this;RoleService.data(function(o){e.reservation=o,console.log(o)})}]);
Booking.controller("ReserveController",["$scope","$stateParams","$state","ReservationService","DataService","$anchorScroll","$location",function(o,r,a,e,t,m,s){s.hash("top"),m(),o.formData={},o.formData.roomDetails=angular.fromJson(atob(r.roomdetails)),o.summary={},o.summary.noRooms=o.formData.roomDetails.selectedrooms.length,o.summary.noGuest=o.formData.roomDetails.querry.adults,o.summary.startdate=o.formData.roomDetails.querry.check_in,o.summary.enddate=o.formData.roomDetails.querry.check_out,o.totalprice=function(){for(var r=0,a=0;a<o.summary.noRooms;a++)r+=o.formData.roomDetails.selectedrooms[a].room.base_price;return r},o.summary.tPrice=o.totalprice(),o.processForm=function(){e.create(o.formData).success(function(r){alert("data saved Reservation ID 9889"),o.formData=""}).error(function(o){alert("Errror "+o.message)})},o.proceed=function(){var r={};r.id="roominfo",r.roomdetails=o.formData,r.summary=o.summary,t.save(r),a.go("guestinfo")}}]);
Booking.controller("ReservePaymentController",["ReservationService",function(e){}]);
Booking.controller("bookingController",["ReservationService",function(o){}]);
Booking.controller("RoleController",["RoleService",function(o){this.role=null,this.data="Booking User Role";var l=this;o.data(function(o){l.role=o,console.log(o)})}]);
Booking.controller("thanknoteController",["$location","$scope","$stateParams",function(o,n,t){n.reservationid=t.reservationid}]);
Booking.controller("UsersController",["UsersService",function(s){this.users=null,this.data="Booking Users";var o=this;s.data(function(s){o.users=s,console.log(s)})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbXBhbnkuanMiLCJjdXN0b21lci5qcyIsIkRhdGFTZXJ2aWNlLmpzIiwiaW52ZW50b3J5LmpzIiwibG9naW4uanMiLCJwb2xpY2llcy5qcyIsInJlc2VydmF0aW9uLmpzIiwicm9sZS5qcyIsInVzZXJzLmpzIiwiYXZhaWxhYmlsaXR5LmpzIiwiZm9vdGVyX25hdi5qcyIsImhvbWUuanMiLCJsZWZ0X25hdi5qcyIsInF1ZXJ5LmpzIiwicmV6X25hdi5qcyIsInRvcF9uYXYuanMiLCJ1c2VyX3Byb2ZpbGUuanMiLCJjb25maXJtYXRpb25Db250cm9sbGVyLmpzIiwiZm9vdGVyLmpzIiwiZ3Vlc3RDb250cm9sbGVyLmpzIiwiaGVhZGVyLmpzIiwibG9nb3V0LmpzIiwicGF5bWVudENvbnRyb2xsZXIuanMiLCJyZXMtaGVhZGVyLmpzIiwiUmVzZXJ2ZUNvbnRyb2xsZXIuanMiLCJSZXNlcnZlUGF5bWVudENvbnRyb2xsZXIuanMiLCJSZXNlcnZlUHJvZmlsZUNvbnRyb2xsZXIuanMiLCJ0aGFua25vdGVDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIkJvb2tpbmciLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImZhY3RvcnkiLCIkaHR0cCIsImRhdGEiLCJjYWxsYmFjayIsImdldCIsInN1Y2Nlc3MiLCJzdGF0dXMiLCJzZXJ2aWNlIiwidGhpcyIsInNhdmUiLCJkdCIsInB1c2giLCJjb25zb2xlIiwibG9nIiwiY29tcGFueV9pZCIsInJlc3VsdHMiLCJxdWVyeSIsInBvc3QiLCJiaW5kIiwiJHJvb3RTY29wZSIsImF1dGgiLCJjcmVkZW50aWFscyIsImVycm9yIiwidXNlciIsIiRjb29raWVzIiwibG9nZ2VkSW4iLCJKU09OIiwicGFyc2UiLCJsb2dvdXQiLCJyZW1vdmUiLCJyZXNlcnZhdGlvbiIsInF1ZXJyeSIsImNyZWF0ZSIsInBlbmRpbmdSZXNlcnZhdGlvbnMiLCJkaXJlY3RpdmUiLCJkYXRlRmlsdGVyIiwicmVzdHJpY3QiLCIkc2NvcGUiLCIkbG9jYXRpb24iLCJSZXNlcnZhdGlvblNlcnZpY2UiLCIkc3RhdGVQYXJhbXMiLCJEYXRhU2VydmljZSIsInNlbGVjdGVkcm9vbXMiLCJudW1iZXIiLCJmcm9tSnNvbiIsImF0b2IiLCJzZWxlY3Ryb29tIiwiaW5kZXgiLCJyb29tIiwicm0iLCJpZCIsInNlbGVjdGVkIiwicmVtb3Zlcm9vbSIsImkiLCJzcGxpY2UiLCJib29rIiwiayIsImNvbXBhbnlpZCIsImRldCIsImJ0b2EiLCJ0b0pzb24iLCJwYXRoIiwic3VibWl0IiwiYWxlcnQiLCJtZXNzYWdlIiwic2NvcGUiLCJ0cmFuc2NsdWRlIiwiSW52ZW50b3J5U2VydmljZSIsIm1heF9hZHVsdHMiLCJtYXhfY2hpbGRzIiwiYWR1bHRzIiwiY2hpbGRzIiwiY2hlY2tfaW4iLCJtb21lbnQiLCJ0b0RhdGUiLCJjaGVja19vdXQiLCJhZGQiLCIkYnJvYWRjYXN0IiwiZm9ybURhdGEiLCJndWVzdGluZm8iLCJfIiwiZmluZFdoZXJlIiwiY3VzdG9tZXJQcm9maWxlIiwiY2FyZGluZm8iLCJwYXltZW50RGV0YWlscyIsImJvb2tpbmdpbmZvIiwiZ3Vlc3RTdW1tYXJ5Iiwicm9vbXNTdW1tYXJ5Iiwic3VtbWFyeSIsInByb2Nlc3NGb3JtIiwicm9vbVN1bW1hcnkiLCJyZXNwIiwiVXNlcnNTZXJ2aWNlIiwiY3VzdG9tZXIiLCJfc2VsZiIsIkN1c3RvbWVyU2VydmljZSIsIiRzdGF0ZSIsInBheW1lbnQiLCJnbyIsIkNvbXBhbnlTZXJ2aWNlIiwiY29tcGFueSIsInJlc3VsdCIsInBlbmRpbmdDb25maXJtYXRpb24iLCIkb24iLCIkd2luZG93IiwiTG9naW5TZXJ2aWNlIiwic2Vzc2lvblN0b3JhZ2UiLCJ0b2tlbiIsImxvY2F0aW9uIiwiaHJlZiIsImdvdG9Db25maXJtIiwicG9saWNpZXMiLCJzaG93IiwiUm9sZVNlcnZpY2UiLCIkYW5jaG9yU2Nyb2xsIiwiaGFzaCIsInJvb21EZXRhaWxzIiwicm9vbWRldGFpbHMiLCJub1Jvb21zIiwibGVuZ3RoIiwibm9HdWVzdCIsInN0YXJ0ZGF0ZSIsImVuZGRhdGUiLCJ0b3RhbHByaWNlIiwidHByaWNlIiwiYmFzZV9wcmljZSIsInRQcmljZSIsInByb2NlZWQiLCJyb2xlIiwicmVzZXJ2YXRpb25pZCIsInVzZXJzIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxRQUVKQSxTQUFVQyxRQUFRQyxPQUFPLFdBQVksWUFBWSwwQ0FFakRGLFFBQVFHLFFBQVEsaUJBQWtCLHFCQUFzQixTQUFTQyxFQUFnQkMsR0FFakZBLEVBQW1CQyxVQUFVLFNBRXpCRixFQUNJRyxNQUFNLFFBQ0hDLElBQUssUUFDSkMsWUFBYSw4QkFDYkMsV0FBWSxtQkFFaEJILE1BQU0sV0FDSEMsSUFBSyxtQkFDSkMsWUFBYSw0QkFHaEJGLE1BQU0sV0FDSkMsSUFBSyx3QkFDSkMsWUFBYSxnQ0FDYkMsV0FBWSxzQkFFZkgsTUFBTSxXQUNIQyxJQUFLLFdBQ0xDLFlBQWEsZ0NBQ2JDLFdBQVksc0JBRWZILE1BQU0sZ0JBQ0hDLElBQUssZ0JBQ0xDLFlBQWEsNENBQ2JDLFdBQVksMkJBR2ZILE1BQU0sYUFDSEMsSUFBSyw0QkFDTEMsWUFBYSxrQ0FDYkMsV0FBWSx3QkFHZkgsTUFBTSxhQUNIQyxJQUFLLGFBQ0xDLFlBQWEsZ0NBQ2JDLFdBQVk7QUM1Q3hCVixRQUFRVyxRQUFRLGtCQUFtQixRQUFTLFNBQVNDLEdBQ25ELE9BQ0VDLEtBQU8sU0FBU0MsR0FDZEYsRUFBTUcsSUFBSSxnQkFDUEMsUUFBUSxTQUFTSCxFQUFNSSxHQUN0QkgsRUFBU0Q7QUNMbkJiLFFBQVFXLFFBQVEsbUJBQW9CLFFBQVMsU0FBU0MsR0FDcEQsT0FDRUMsS0FBTyxTQUFTQyxHQUNkRixFQUFNRyxJQUFJLGlCQUNQQyxRQUFRLFNBQVNILEVBQU1JLEdBQ3RCSCxFQUFTRDtBQ0xuQmIsUUFB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QUFTdUMsRUFBVUQsRUFBT0csR0FDdEdILEVBQU80RixjQUFlekYsRUFBYXlGO0FuQkh2QzVJLFFBQVFVLFdBQVcsbUJBQW9CLGVBQWdCLFNBQVM2RixHQUM5RHBGLEtBQUswSCxNQUFRLEtBQ2IxSCxLQUFLTixLQUFPLGVBQ1osSUFBSTRGLEdBQVF0RixJQUVab0YsR0FBYTFGLEtBQUssU0FBU0EsR0FDekI0RixFQUFNb0MsTUFBUWhJLEVBQ2RVLFFBQVFDLElBQUlYIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBCb29raW5nO1xuXG5Cb29raW5nID0gYW5ndWxhci5tb2R1bGUoJ0Jvb2tpbmcnLCBbJ3VpLnJvdXRlcicsJ2FuZ3VsYXJVdGlscy5kaXJlY3RpdmVzLmRpclBhZ2luYXRpb24nXSk7XG5cbkJvb2tpbmcuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcil7XG4gXG4kdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvaG9tZScpO1xuIFxuICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICAgICB1cmw6ICcvaG9tZScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvdmlld3MvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgLnN0YXRlKCdib29raW5nJywge1xuICAgICAgICAgICB1cmw6ICcvYm9va2luZy86cXVlcnJ5JyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9ib29raW5nLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgXG4gICAgICAgIC5zdGF0ZSgncmVzZXJ2ZScsIHtcbiAgICAgICAgICAgdXJsOiAnL3Jlc2VydmUvOnJvb21kZXRhaWxzJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy92aWV3cy9yZXNlcnZlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Jlc2VydmVDb250cm9sbGVyJ1xuICAgICAgICB9KSBcbiAgICAgICAgLnN0YXRlKCdwYXltZW50Jywge1xuICAgICAgICAgICAgdXJsOiAnL3BheW1lbnQnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3ZpZXdzL3BheW1lbnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncGF5bWVudENvbnRyb2xsZXInXG4gICAgICAgIH0pXG4gICAgICAgIC5zdGF0ZSgnQ29uZmlybWF0aW9uJywge1xuICAgICAgICAgICAgdXJsOiAnL0NvbmZpcm1hdGlvbicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvdmlld3MvcGF5bWVudENvbmZpcm1hdGlvbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjb25maXJtYXRpb25Db250cm9sbGVyJ1xuXG4gICAgICAgIH0pXG4gICAgICAgIC5zdGF0ZSgndGhhbmtub3RlJywge1xuICAgICAgICAgICAgdXJsOiAnL3RoYW5rbm90ZS86cmVzZXJ2YXRpb25pZCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvdmlld3MvdGhhbmtub3RlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3RoYW5rbm90ZUNvbnRyb2xsZXInXG5cbiAgICAgICAgfSlcbiAgICAgICAgLnN0YXRlKCdndWVzdGluZm8nLCB7XG4gICAgICAgICAgICB1cmw6ICcvZ3Vlc3RpbmZvJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy92aWV3cy9wcm9maWxlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2d1ZXN0Q29udHJvbGxlcidcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBcblxuICAgICAgICBcbiAgICAgICBcblxuXG59XSk7XG5cbiIsIkJvb2tpbmcuZmFjdG9yeSgnQ29tcGFueVNlcnZpY2UnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApe1xuICByZXR1cm4ge1xuICAgIGRhdGEgOiBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgJGh0dHAuZ2V0KCcvYXBpL2NvbXBhbnknKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpe1xuICAgICAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH07XG5cbn1dKTtcbiIsIkJvb2tpbmcuY29udHJvbGxlcignQ3VzdG9tZXJDb250cm9sbGVyJywgWydDdXN0b21lclNlcnZpY2UnLCBmdW5jdGlvbihVc2Vyc1NlcnZpY2Upe1xuICB0aGlzLmN1c3RvbWVyID0gbnVsbDtcbiAgdGhpcy5kYXRhID0gJ0Jvb2tpbmcgQ3VzdG9tZXInO1xuICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gIEN1c3RvbWVyU2VydmljZS5kYXRhKGZ1bmN0aW9uKGRhdGEpe1xuICAgIF9zZWxmLmN1c3RvbWVyID0gZGF0YTtcbiAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgfSk7XG59XSk7IiwiQm9va2luZy5zZXJ2aWNlKCdEYXRhU2VydmljZScsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCl7XG5cblx0ICB2YXIgZGF0YT1bXVxuXG5cblx0ICAgdGhpcy5zYXZlPWZ1bmN0aW9uKGR0KXtcblx0ICAgICBcdGRhdGEucHVzaChkdCk7XG5cdCAgICAgXHRjb25zb2xlLmxvZyhcImRhdGEgU2F2ZWRcIik7XG5cdCAgICAgXHRjb25zb2xlLmxvZyhkYXRhKTtcblxuXHQgICB9XG5cdCAgIHRoaXMuZ2V0PWZ1bmN0aW9uKCl7XG5cdCAgIFx0cmV0dXJuIGRhdGE7XG5cdCAgIH1cblxuICAgICBcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ0ludmVudG9yeUNvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnSW52ZW50b3J5U2VydmljZScsIGZ1bmN0aW9uKCRyb290U2NvcGUsIEludmVudG9yeVNlcnZpY2Upe1xuICB0aGlzLnJlc3VsdHMgPSBJbnZlbnRvcnlTZXJ2aWNlLnJlc3VsdHM7XG5cbiAgJHJvb3RTY29wZS4kb24oJ3F1ZXJ5OnJlc3VsdHMnLCBmdW5jdGlvbigpe1xuICAgIHRoaXMucmVzdWx0cyA9IEludmVudG9yeVNlcnZpY2UucmVzdWx0cztcbiAgfS5iaW5kKHRoaXMpKTtcblxuXG5cbn1dKTtcbiIsIkJvb2tpbmcuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckd2luZG93JywgJ0xvZ2luU2VydmljZScsXG4gIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdywgTG9naW5TZXJ2aWNlKXtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgIExvZ2luU2VydmljZS5hdXRoKCRzY29wZS51c2VyLCBmdW5jdGlvbihkYXRhLCBzdGF0dXMpe1xuICAgICAgICBpZiAoc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS50b2tlbiA9IGRhdGEudG9rZW47XG4gICAgICAgICAgJHJvb3RTY29wZS5sb2dnZWRJbiA9IGRhdGE7XG4gICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbi5ocmVmPScvQWRtaW4uaHRtbCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS50b2tlbjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICB9XVxuKTtcblxuIiwiQm9va2luZy5jb250cm9sbGVyKCdQb2xpY2llc0NvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uKXtcbiAgICAkc2NvcGUucG9saWNpZXMgPSBmdW5jdGlvbihzaG93KSB7XG4gICAgICByZXR1cm4gcG9saWNpZXMuc2hvdyA9IHRydWU7ICBcbiAgICB9O1xuICB9XG5dKTtcblxuIiwiQm9va2luZy5jb250cm9sbGVyKCdSZXNlcnZhdGlvbkNvbnRyb2xsZXInLCBbJ1Jlc2VydmF0aW9uU2VydmljZScsIGZ1bmN0aW9uKFJlc2VydmF0aW9uU2VydmljZSl7XG4gIHRoaXMucmVzZXJ2YXRpb24gPSBudWxsO1xuICB0aGlzLmRhdGEgPSAnQm9va2luZyBSZXJzZXJ2YXRpb24nO1xuICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gIFJvbGVTZXJ2aWNlLmRhdGEoZnVuY3Rpb24oZGF0YSl7XG4gICAgX3NlbGYucmVzZXJ2YXRpb24gPSBkYXRhO1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICB9KTtcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ1JvbGVDb250cm9sbGVyJywgWydSb2xlU2VydmljZScsIGZ1bmN0aW9uKFJvbGVTZXJ2aWNlKXtcbiAgdGhpcy5yb2xlID0gbnVsbDtcbiAgdGhpcy5kYXRhID0gJ0Jvb2tpbmcgVXNlciBSb2xlJztcbiAgdmFyIF9zZWxmID0gdGhpcztcblxuICBSb2xlU2VydmljZS5kYXRhKGZ1bmN0aW9uKGRhdGEpe1xuICAgIF9zZWxmLnJvbGUgPSBkYXRhO1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICB9KTtcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ1VzZXJzQ29udHJvbGxlcicsIFsnVXNlcnNTZXJ2aWNlJywgZnVuY3Rpb24oVXNlcnNTZXJ2aWNlKXtcbiAgdGhpcy51c2VycyA9IG51bGw7XG4gIHRoaXMuZGF0YSA9ICdCb29raW5nIFVzZXJzJztcbiAgdmFyIF9zZWxmID0gdGhpcztcblxuICBVc2Vyc1NlcnZpY2UuZGF0YShmdW5jdGlvbihkYXRhKXtcbiAgICBfc2VsZi51c2VycyA9IGRhdGE7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG4gIH0pO1xufV0pOyIsIkJvb2tpbmcuZGlyZWN0aXZlKCdhdmFpbGFiaWxpdHknLCBbJyRyb290U2NvcGUnLCAnZGF0ZUZpbHRlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsIGRhdGVGaWx0ZXIpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0ICAgIDogJ0UnLFxuICAgIHRlbXBsYXRlVXJsIDogJy90ZW1wbGF0ZXMvZGlyZWN0aXZlcy9hdmFpbGFiaWxpdHkuaHRtbCcsXG4gICAgY29udHJvbGxlciAgOiBbJyRzY29wZScsJyRsb2NhdGlvbicsJ1Jlc2VydmF0aW9uU2VydmljZScsJyRzdGF0ZVBhcmFtcycsJ0RhdGFTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCRsb2NhdGlvbixSZXNlcnZhdGlvblNlcnZpY2UsJHN0YXRlUGFyYW1zLERhdGFTZXJ2aWNlKXtcbiAgICAgIFxuICAgICAgJHNjb3BlLnNlbGVjdGVkcm9vbXM9W107XG4gICAgICAkc2NvcGUubnVtYmVyPS0xO1xuICAkc2NvcGUucXVlcnJ5PSBhbmd1bGFyLmZyb21Kc29uKGF0b2IoJHN0YXRlUGFyYW1zLnF1ZXJyeSkpXG4gICAgIFxuXG4kc2NvcGUuc2VsZWN0cm9vbT1mdW5jdGlvbihpbmRleCxyb29tKXtcbiAgIHZhciBybT17fTtcbiAgICBybS5pZD1pbmRleDtcbiAgICBybS5yb29tPXJvb207XG4gICAgcm9vbS5zZWxlY3RlZD10cnVlO1xuICAgICRzY29wZS5zZWxlY3RlZHJvb21zLnB1c2gocm0pO1xuICAgICRzY29wZS5udW1iZXI9aW5kZXg7XG4gICAgY29uc29sZS5sb2coJHNjb3BlLnNlbGVjdGVkcm9vbXMpXG59O1xuJHNjb3BlLnJlbW92ZXJvb209ZnVuY3Rpb24oaW5kZXgpe1xuXG4gICBmb3IgKGkgaW4gJHNjb3BlLnNlbGVjdGVkcm9vbXMpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuc2VsZWN0ZWRyb29tc1tpXS5pZCA9PSBpbmRleCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZHJvb21zLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxufTtcblxuJHNjb3BlLmJvb2s9ZnVuY3Rpb24oKXtcbiAgdmFyIGs9e307XG4gICAgIGsuc2VsZWN0ZWRyb29tcz0kc2NvcGUuc2VsZWN0ZWRyb29tcztcbiAgICAgay5xdWVycnk9JHNjb3BlLnF1ZXJyeTtcbiAgICAgay5jb21wYW55aWQ9JHNjb3BlLnNlbGVjdGVkcm9vbXNbMF0ucm9vbS5jb21wYW55X2lkO1xuICAgICBrLmlkPSdib29raW5naW5mbyc7XG4gICB2YXIgZGV0PWJ0b2EoYW5ndWxhci50b0pzb24oaykpO1xuICAgRGF0YVNlcnZpY2Uuc2F2ZShrKTtcbiAgJGxvY2F0aW9uLnBhdGgoJy9yZXNlcnZlLycrZGV0KTtcbiAgXG59O1xuXG4gICAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgIFJlc2VydmF0aW9uU2VydmljZS5xdWVyeSgkc2NvcGUucXVlcnkpXG4gICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJyb3IgXCIrZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9KTsgIFxuICAgICAgICBcbiAgICAgIH07XG4gICAgfV1cbiAgfTtcbn1dKTsiLCJCb29raW5nLmRpcmVjdGl2ZSgnZm9vdGVyTmF2JywgW2Z1bmN0aW9uKCl7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3QgICAgOiAnRScsXG4gICAgc2NvcGUgICAgICAgOiB7fSxcbiAgICB0cmFuc2NsdWRlICA6IHRydWUsXG4gICAgdGVtcGxhdGVVcmwgOiAnL3RlbXBsYXRlcy9kaXJlY3RpdmVzL2Zvb3Rlci5odG1sJyxcbiAgICBjb250cm9sbGVyICA6ICdGb290ZXJDb250cm9sbGVyJ1xuICB9O1xufV0pO1xuXG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgWydDb21wYW55U2VydmljZScsJ1Jlc2VydmF0aW9uU2VydmljZScsJyRzY29wZScsIGZ1bmN0aW9uKENvbXBhbnlTZXJ2aWNlLFJlc2VydmF0aW9uU2VydmljZSwkc2NvcGUpe1xuICB0aGlzLmNvbXBhbnkgPSBudWxsO1xuICB0aGlzLmRhdGEgPSAnQm9va2luZyBIb21lJztcbiAgdmFyIF9zZWxmID0gdGhpcztcblxuICBDb21wYW55U2VydmljZS5kYXRhKGZ1bmN0aW9uKGRhdGEpe1xuICAgIF9zZWxmLmNvbXBhbnkgPSBkYXRhO1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICB9KTtcblxuIFJlc2VydmF0aW9uU2VydmljZS5wZW5kaW5nUmVzZXJ2YXRpb25zKClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKXsgXG4gICAgICAgICAgICBcdGNvbnNvbGUubG9nKFwicGVuZGluZyBSZXNlcnZhdGlvbiBcIik7XG4gICAgICAgICAgICBcdGNvbnNvbGUubG9nKGRhdGEucmVzdWx0KTtcblxuICAgICAgICAgICAgXHQkc2NvcGUucGVuZGluZ0NvbmZpcm1hdGlvbj1kYXRhLnJlc3VsdDtcblx0XHRcdCAgIH0pXG5cdFx0ICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHQgICBcdGNvbnNvbGUubG9nKFwiRXJyb3IgaW4gcGVuZGluZyBSZXNlcnZhdGlvbiBcIik7XG4gICAgICAgICAgICBcdGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgXHQkc2NvcGUucGVuZGluZ0NvbmZpcm1hdGlvbj1bXTtcblxuXHRcdCAgICAgfSk7XG5cblxuXG59XSk7XG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ0xlZnROYXZDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xufV0pO1xuXG4iLCJCb29raW5nLmRpcmVjdGl2ZSgncXVlcnknLCBbJyRyb290U2NvcGUnLCAnZGF0ZUZpbHRlcicsJyRsb2NhdGlvbicgLGZ1bmN0aW9uKCRyb290U2NvcGUsIGRhdGVGaWx0ZXIsJGxvY2F0aW9uKXtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdCAgICA6ICdFJyxcbiAgICB0ZW1wbGF0ZVVybCA6ICcvdGVtcGxhdGVzL2RpcmVjdGl2ZXMvcXVlcnkuaHRtbCcsXG4gICAgY29udHJvbGxlciAgOiBbJyRzY29wZScsICdJbnZlbnRvcnlTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCBJbnZlbnRvcnlTZXJ2aWNlKXtcbiAgICAgICRzY29wZS5tYXhfYWR1bHRzID0gWzEsMiwzXTtcbiAgICAgICRzY29wZS5tYXhfY2hpbGRzID0gWzAsMSwyLDNdO1xuICAgICAgJHNjb3BlLnF1ZXJ5ID0ge1xuICAgICAgICBhZHVsdHM6IDEsXG4gICAgICAgIGNoaWxkczogMCxcbiAgICAgICAgY2hlY2tfaW46IG5ldyBtb21lbnQoKS50b0RhdGUoKSxcbiAgICAgICAgY2hlY2tfb3V0OiBuZXcgbW9tZW50KCkuYWRkKDMsICdkYXlzJykudG9EYXRlKClcbiAgICAgIH07XG5cbiAgICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBJbnZlbnRvcnlTZXJ2aWNlLnF1ZXJ5KCRzY29wZS5xdWVyeSwgZnVuY3Rpb24ocmVzdWx0cyl7XG4gICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdxdWVyeTpyZXN1bHRzJyk7XG4gICAgICAgIH0pO1xuICAgICAgICAgICAgIHZhciBkZXQ9YnRvYShhbmd1bGFyLnRvSnNvbigkc2NvcGUucXVlcnkpKTtcbiAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2Jvb2tpbmcvJytkZXQpO1xuICAgICAgfVxuICAgIH1dXG4gIH07XG59XSk7XG5cbiIsIkJvb2tpbmcuZGlyZWN0aXZlKCdyZXNOYXYnLCBbZnVuY3Rpb24oKXtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdCAgICA6ICdFJyxcbiAgICBzY29wZSAgICAgICA6IHt9LFxuICAgIHRyYW5zY2x1ZGUgIDogdHJ1ZSxcbiAgICB0ZW1wbGF0ZVVybCA6ICcvdGVtcGxhdGVzL2RpcmVjdGl2ZXMvcmVzLW5hdi5odG1sJyxcbiAgICBjb250cm9sbGVyICA6ICdSZXNDb250cm9sbGVyJ1xuICB9O1xufV0pO1xuXG4iLCJCb29raW5nLmRpcmVjdGl2ZSgndG9wTmF2JywgW2Z1bmN0aW9uKCl7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3QgICAgOiAnRScsXG4gICAgc2NvcGUgICAgICAgOiB7fSxcbiAgICB0cmFuc2NsdWRlICA6IHRydWUsXG4gICAgdGVtcGxhdGVVcmwgOiAnL3RlbXBsYXRlcy9kaXJlY3RpdmVzL2hlYWRlci5odG1sJyxcbiAgICBjb250cm9sbGVyICA6ICdIZWFkZXJDb250cm9sbGVyJ1xuICB9O1xufV0pO1xuXG4iLCJCb29raW5nLmRpcmVjdGl2ZSgndXNlcl9wcm9maWxlJywgW2Z1bmN0aW9uKCl7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3QgICAgOiAnRScsXG4gICAgdGVtcGxhdGVVcmwgOiAnL3RlbXBsYXRlcy91c2VyX3Byb2ZpbGUuaHRtbCdcbiAgfTtcbn1dKTtcbiIsIkJvb2tpbmcuY29udHJvbGxlcignY29uZmlybWF0aW9uQ29udHJvbGxlcicsIFsnRGF0YVNlcnZpY2UnLCckbG9jYXRpb24nLCckc2NvcGUnLCdSZXNlcnZhdGlvblNlcnZpY2UnLCBmdW5jdGlvbihEYXRhU2VydmljZSwkbG9jYXRpb24sJHNjb3BlLFJlc2VydmF0aW9uU2VydmljZSl7XG4gICAkc2NvcGUuZm9ybURhdGE9RGF0YVNlcnZpY2UuZ2V0KCk7ICAgICBcbiAgICRzY29wZS5ndWVzdGluZm89IF8uZmluZFdoZXJlKCRzY29wZS5mb3JtRGF0YSwge2lkOlwiZ3Vlc3RpbmZvXCJ9KS5jdXN0b21lclByb2ZpbGU7XG4gICAkc2NvcGUuY2FyZGluZm89Xy5maW5kV2hlcmUoJHNjb3BlLmZvcm1EYXRhLCB7aWQ6XCJwYXltZW50aW5mb1wifSkucGF5bWVudERldGFpbHM7XG4gICAkc2NvcGUuYm9va2luZ2luZm89Xy5maW5kV2hlcmUoJHNjb3BlLmZvcm1EYXRhLCB7aWQ6XCJib29raW5naW5mb1wifSkuc2VsZWN0ZWRyb29tcztcbiAgICAkc2NvcGUuZ3Vlc3RTdW1tYXJ5PV8uZmluZFdoZXJlKCRzY29wZS5mb3JtRGF0YSwge2lkOlwiYm9va2luZ2luZm9cIn0pLnF1ZXJyeTtcbiAgICAkc2NvcGUucm9vbXNTdW1tYXJ5PV8uZmluZFdoZXJlKCRzY29wZS5mb3JtRGF0YSwge2lkOlwicm9vbWluZm9cIn0pLnN1bW1hcnk7XG4gICAkc2NvcGUuY29tcGFueV9pZD1fLmZpbmRXaGVyZSgkc2NvcGUuZm9ybURhdGEsIHtpZDpcImJvb2tpbmdpbmZvXCJ9KS5jb21wYW55aWQ7XG5cbiAgIFxuXG4gICAkc2NvcGUucHJvY2Vzc0Zvcm09ZnVuY3Rpb24oKXtcbiAgICB2YXIgZGF0YSA9e307XG4gICAgICAgIGRhdGEuZ3Vlc3RpbmZvPSRzY29wZS5ndWVzdGluZm87XG4gICAgICAgIGRhdGEuY2FyZGluZm89JHNjb3BlLmNhcmRpbmZvO1xuICAgICAgICBkYXRhLmJvb2tpbmdpbmZvPSRzY29wZS5ib29raW5naW5mbztcbiAgICAgICAgIGRhdGEuZ3Vlc3RTdW1tYXJ5PSRzY29wZS5ndWVzdFN1bW1hcnk7XG4gICAgICAgICBkYXRhLnJvb21TdW1tYXJ5PSRzY29wZS5yb29tc1N1bW1hcnk7XG4gICAgICAgICBkYXRhLmNvbXBhbnlfaWQ9JHNjb3BlLmNvbXBhbnlfaWQ7XG5cblxuICAgICBSZXNlcnZhdGlvblNlcnZpY2UuY3JlYXRlKGRhdGEpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICAgICAgICAgIC8vICBhbGVydChyZXNwLnN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybURhdGE9XCJcIjtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3RoYW5rbm90ZS8nK3Jlc3Auc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy9jbGVhciBkYXRhIHNlcnZpY2UgZGF0YVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAocmVzcCkge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiRXJycm9yIFwiK3Jlc3ApO1xuICAgICAgICAgICAgfSk7ICBcblxuICAgfTtcbiAgIFxuXG59XSk7IiwiQm9va2luZy5jb250cm9sbGVyKCdGb290ZXJDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xufV0pO1xuXG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ2d1ZXN0Q29udHJvbGxlcicsIFsnRGF0YVNlcnZpY2UnLCckc3RhdGUnLCckc2NvcGUnLCBmdW5jdGlvbihEYXRhU2VydmljZSwkc3RhdGUsJHNjb3BlKXtcbiAgICRzY29wZS5mb3JtRGF0YT17fTtcblxuXG4gICAkc2NvcGUucGF5bWVudD1mdW5jdGlvbigpe1xuXG5cdCAgIFx0IHZhciBkYXRhPXt9O1xuXHQgICBcdCBkYXRhLmlkPSdndWVzdGluZm8nO1xuXHQgICBcdCBkYXRhLmN1c3RvbWVyUHJvZmlsZT0kc2NvcGUuZm9ybURhdGE7XG5cdCAgIFx0RGF0YVNlcnZpY2Uuc2F2ZShkYXRhKTtcblx0ICAgXHQkc3RhdGUuZ28oJ3BheW1lbnQnKTtcbiAgIH07XG5cbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ0hlYWRlckNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7XG59XSk7XG5cbiIsIkJvb2tpbmcuY29udHJvbGxlcignTG9nb3V0Q29udHJvbGxlcicsIFsnJGxvY2F0aW9uJywgJ0xvZ2luU2VydmljZScsIGZ1bmN0aW9uKCRsb2NhdGlvbiwgTG9naW5TZXJ2aWNlKXtcbiAgTG9naW5TZXJ2aWNlLmxvZ291dCgpO1xuICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG59XSk7XG5cblxuIiwiQm9va2luZy5jb250cm9sbGVyKCdwYXltZW50Q29udHJvbGxlcicsIFsnRGF0YVNlcnZpY2UnLCckc3RhdGUnLCckc2NvcGUnLCBmdW5jdGlvbihEYXRhU2VydmljZSwkc3RhdGUsJHNjb3BlKXtcbiAgICRzY29wZS5mb3JtRGF0YT17fTtcblxuXG4gICAkc2NvcGUuZ290b0NvbmZpcm09ZnVuY3Rpb24oKXtcblx0ICAgXHQgdmFyIGRhdGE9e307XG5cdCAgIFx0IGRhdGEuaWQ9J3BheW1lbnRpbmZvJztcblx0ICAgXHQgZGF0YS5wYXltZW50RGV0YWlscz0kc2NvcGUuZm9ybURhdGE7XG5cdCAgIFx0RGF0YVNlcnZpY2Uuc2F2ZShkYXRhKTtcblx0ICAgXHQkc3RhdGUuZ28oJ0NvbmZpcm1hdGlvbicpO1xuICAgfTtcblxufV0pOyIsIkJvb2tpbmcuY29udHJvbGxlcignUmVzQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKXtcbn1dKTtcblxuIiwiQm9va2luZy5jb250cm9sbGVyKCdSZXNlcnZlQ29udHJvbGxlcicsIFsnJHNjb3BlJywnJHN0YXRlUGFyYW1zJywnJHN0YXRlJywnUmVzZXJ2YXRpb25TZXJ2aWNlJywgJ0RhdGFTZXJ2aWNlJywnJGFuY2hvclNjcm9sbCcsJyRsb2NhdGlvbicsZnVuY3Rpb24oJHNjb3BlLCRzdGF0ZVBhcmFtcywkc3RhdGUsUmVzZXJ2YXRpb25TZXJ2aWNlLERhdGFTZXJ2aWNlLCRhbmNob3JTY3JvbGwsJGxvY2F0aW9uKXtcbiAgICRsb2NhdGlvbi5oYXNoKCd0b3AnKTtcblxuICAgICAgLy8gY2FsbCAkYW5jaG9yU2Nyb2xsKClcbiAgICAgICRhbmNob3JTY3JvbGwoKTtcblxuXHRcbiAgJHNjb3BlLmZvcm1EYXRhID0ge307XG4gJHNjb3BlLmZvcm1EYXRhLnJvb21EZXRhaWxzPWFuZ3VsYXIuZnJvbUpzb24oYXRvYigkc3RhdGVQYXJhbXMucm9vbWRldGFpbHMpKTtcbiAgLy9jb25zb2xlLmxvZygkc2NvcGUuZm9ybURhdGEucm9vbURldGFpbHMpO1xuXG4gICRzY29wZS5zdW1tYXJ5PXt9O1xuICAkc2NvcGUuc3VtbWFyeS5ub1Jvb21zPSRzY29wZS5mb3JtRGF0YS5yb29tRGV0YWlscy5zZWxlY3RlZHJvb21zLmxlbmd0aDtcbiAgJHNjb3BlLnN1bW1hcnkubm9HdWVzdD0gJHNjb3BlLmZvcm1EYXRhLnJvb21EZXRhaWxzLnF1ZXJyeS5hZHVsdHM7IFxuICAkc2NvcGUuc3VtbWFyeS5zdGFydGRhdGU9JHNjb3BlLmZvcm1EYXRhLnJvb21EZXRhaWxzLnF1ZXJyeS5jaGVja19pbjtcbiAgJHNjb3BlLnN1bW1hcnkuZW5kZGF0ZT0kc2NvcGUuZm9ybURhdGEucm9vbURldGFpbHMucXVlcnJ5LmNoZWNrX291dDtcblxuICAkc2NvcGUudG90YWxwcmljZT1mdW5jdGlvbigpe1xuICAgICAgICB2YXIgdHByaWNlPTA7XG4gICAgICAgIFxuXG4gICAgICAgZm9yICh2YXIgaT0wICA7aTwkc2NvcGUuc3VtbWFyeS5ub1Jvb21zO2krKyl7XG5cbiAgICAgICAgICAgdHByaWNlPXRwcmljZSskc2NvcGUuZm9ybURhdGEucm9vbURldGFpbHMuc2VsZWN0ZWRyb29tc1tpXS5yb29tLmJhc2VfcHJpY2U7XG4gICAgICAgfVxuICAgICAgICByZXR1cm4gdHByaWNlO1xuICAgICAgfTtcblxuXG5cbiRzY29wZS5zdW1tYXJ5LnRQcmljZT0gJHNjb3BlLnRvdGFscHJpY2UoKTsgXG5cbiAgICBcbiAgICAvLyBmdW5jdGlvbiB0byBwcm9jZXNzIHRoZSBmb3JtXG4gICAgJHNjb3BlLnByb2Nlc3NGb3JtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgLy8gYWxlcnQoJ2F3ZXNvbWUhJyk7XG5cbiAgICAgICAgICBSZXNlcnZhdGlvblNlcnZpY2UuY3JlYXRlKCRzY29wZS5mb3JtRGF0YSlcbiAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBhbGVydChcImRhdGEgc2F2ZWQgUmVzZXJ2YXRpb24gSUQgOTg4OVwiKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybURhdGE9XCJcIjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJyb3IgXCIrZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9KTsgIFxuXG5cbiAgICB9O1xuXG5cbiAgICAkc2NvcGUucHJvY2VlZD1mdW5jdGlvbigpe1xuICAgICAgdmFyIGRhdGE9e307XG4gICAgICAgIGRhdGEuaWQ9J3Jvb21pbmZvJztcbiAgICAgICAgZGF0YS5yb29tZGV0YWlscz0kc2NvcGUuZm9ybURhdGE7XG4gICAgICAgIGRhdGEuc3VtbWFyeT0kc2NvcGUuc3VtbWFyeTtcbiAgICAgICAgIERhdGFTZXJ2aWNlLnNhdmUoZGF0YSk7XG4gICAgICAgICAgICRzdGF0ZS5nbygnZ3Vlc3RpbmZvJyk7XG4gICAgfTtcblxuICAgIFxufV0pOyIsIkJvb2tpbmcuY29udHJvbGxlcignUmVzZXJ2ZVBheW1lbnRDb250cm9sbGVyJywgWydSZXNlcnZhdGlvblNlcnZpY2UnLCBmdW5jdGlvbihSZXNlcnZhdGlvblNlcnZpY2Upe1xuXG59XSk7IiwiQm9va2luZy5jb250cm9sbGVyKCdib29raW5nQ29udHJvbGxlcicsIFsnUmVzZXJ2YXRpb25TZXJ2aWNlJywgZnVuY3Rpb24oUmVzZXJ2YXRpb25TZXJ2aWNlKXtcblxufV0pOyIsIlxuXG5Cb29raW5nLmNvbnRyb2xsZXIoJ3RoYW5rbm90ZUNvbnRyb2xsZXInLCBbJyRsb2NhdGlvbicsJyRzY29wZScsJyRzdGF0ZVBhcmFtcycgLGZ1bmN0aW9uKCRsb2NhdGlvbiwkc2NvcGUsJHN0YXRlUGFyYW1zKXtcbiAgICAkc2NvcGUucmVzZXJ2YXRpb25pZD0gJHN0YXRlUGFyYW1zLnJlc2VydmF0aW9uaWQ7XG5cblx0fV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==