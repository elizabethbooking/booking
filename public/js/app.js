var Booking;Booking=angular.module("Booking",["ngCookies","ui.router","angularUtils.directives.dirPagination"]),Booking.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/home"),e.state("home",{url:"/home",templateUrl:"/templates/views/index.html",controller:"HomeController"}).state("booking",{url:"/booking/:querry",templateUrl:"/templates/booking.html"}).state("reserve",{url:"/reserve/:roomdetails",templateUrl:"/templates/views/reserve.html",controller:"ReserveController"}).state("payment",{url:"/payment",templateUrl:"/templates/views/payment.html",controller:"paymentController"}).state("Confirmation",{url:"/Confirmation",templateUrl:"/templates/views/paymentConfirmation.html",controller:"confirmationController"}).state("guestinfo",{url:"/guestinfo",templateUrl:"/templates/views/profile.html",controller:"guestController"})}]);
Booking.factory("CompanyService",["$http",function(n){return{data:function(t){n.get("/api/company").success(function(n,c){t(n)})}}}]);
Booking.factory("CustomerService",["$http",function(t){return{data:function(c){t.get("/api/customer").success(function(t,n){c(t)})}}}]);
Booking.service("DataService",["$http",function(o){var t=[];this.save=function(o){t.push(o),console.log("data Saved"),console.log(t)},this.get=function(){return t}}]);
Booking.factory("InventoryService",["$http",function(t){var n=10001;return{results:[],data:function(n){t.get("/api/inventory").success(function(t,i){n(t)})},query:function(i,s){t.post("/api/availability/"+n,i).success(function(t,n){this.results=t,s(t)}.bind(this))}}}]);
Booking.factory("LoginService",["$http","$cookies","$rootScope",function(o,n,e){return{auth:function(e,r){o.post("/api/login",e).success(function(o,e){n.put("user",JSON.stringify(o)),r(o,e)}).error(function(){console.log("error")})},user:function(){var o=null;return n.get("user")&&(e.loggedIn=o=JSON.parse(n.get("user"))),o},logout:function(){e.loggedIn=null,n.remove("user")}}}]);
Booking.factory("PoliciesService",["$http",function(i){return{data:function(c){i.get("/api/policies").success(function(i,t){c(i)})}}}]);
Booking.factory("ReservationService",["$http",function(r){var t={};return t.data=function(){return r.get("/api/reservation")},t.query=function(t){return r.get("/api/reservation")},t.create=function(t){return r.post("/api/reservation",t)},t}]);
Booking.factory("RoleService",["$http",function(t){return{data:function(n){t.get("/api/role").success(function(t,o){n(t)})}}}]);
Booking.factory("UsersService",["$http",function(t){return{data:function(n){t.get("/api/users").success(function(t,c){n(t)})}}}]);
Booking.directive("availability",["$rootScope","dateFilter",function(e,o){return{restrict:"E",templateUrl:"/templates/directives/availability.html",controller:["$scope","$location","ReservationService","$stateParams","DataService",function(e,o,r,t,s){e.selectedrooms=[],e.number=-1,e.querry=angular.fromJson(atob(t.querry)),e.selectroom=function(o,r){var t={};t.id=o,t.room=r,r.selected=!0,e.selectedrooms.push(t),e.number=o,console.log(e.selectedrooms)},e.removeroom=function(o){for(i in e.selectedrooms)e.selectedrooms[i].id==o&&e.selectedrooms.splice(i,1)},e.book=function(){var r={};r.selectedrooms=e.selectedrooms,r.querry=e.querry,r.companyid=e.selectedrooms[0].room.company_id,r.id="bookinginfo";var t=btoa(angular.toJson(r));s.save(r),o.path("/reserve/"+t)},e.submit=function(){r.query(e.query).success(function(e){}).error(function(e){alert("Errror "+e.message)})}}]}}]);
Booking.directive("footerNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/footer.html",controller:"FooterController"}}]);
Booking.directive("home",[function(){return{restrict:"E",templateUrl:"/templates/home.html"}}]);
Booking.directive("inventory",[function(){return{restrict:"E",templateUrl:"/templates/inventory.html"}}]);
Booking.directive("leftNav",[function(){return{restrict:"A",scope:{},transclude:!0,templateUrl:"/templates/directives/left_nav.html",controller:"LeftNavController"}}]);
Booking.directive("login",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/login.html",controller:"LoginController"}}]);
Booking.directive("policies",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/policies.html",controller:"PoliciesController"}}]);
Booking.directive("query",["$rootScope","dateFilter","$location",function(t,e,o){return{restrict:"E",templateUrl:"/templates/directives/query.html",controller:["$scope","InventoryService",function(e,r){e.max_adults=[1,2,3],e.max_childs=[0,1,2,3],e.query={adults:1,childs:0,check_in:(new moment).toDate(),check_out:(new moment).add(3,"days").toDate()},e.submit=function(){r.query(e.query,function(e){t.$broadcast("query:results")});var n=btoa(angular.toJson(e.query));o.path("/booking/"+n)}}]}}]);
Booking.directive("resNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/res-nav.html",controller:"ResController"}}]);
Booking.directive("topNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/header.html",controller:"HeaderController"}}]);
Booking.directive("users",[function(){return{restrict:"E",templateUrl:"/templates/users.html"}}]);
Booking.directive("user_profile",[function(){return{restrict:"E",templateUrl:"/templates/user_profile.html"}}]);
Booking.controller("confirmationController",["DataService","$state","$scope","ReservationService",function(o,r,i,n){i.formData=o.get(),i.guestinfo=_.findWhere(i.formData,{id:"guestinfo"}).customerProfile,i.cardinfo=_.findWhere(i.formData,{id:"paymentinfo"}).paymentDetails,i.bookinginfo=_.findWhere(i.formData,{id:"bookinginfo"}).selectedrooms,i.guestSummary=_.findWhere(i.formData,{id:"bookinginfo"}).querry,i.roomsSummary=_.findWhere(i.formData,{id:"roominfo"}).summary,i.company_id=_.findWhere(i.formData,{id:"bookinginfo"}).companyid,i.processForm=function(){var o={};o.guestinfo=i.guestinfo,o.cardinfo=i.cardinfo,o.bookinginfo=i.bookinginfo,o.guestSummary=i.guestSummary,o.roomSummary=i.roomsSummary,o.company_id=i.company_id,n.create(o).success(function(o){alert(o),console.log(o),i.formData=""}).error(function(o){alert("Errror "+o)})}}]);
Booking.controller("CustomerController",["CustomerService",function(o){this.customer=null,this.data="Booking Customer";var t=this;CustomerService.data(function(o){t.customer=o,console.log(o)})}]);
Booking.controller("FooterController",["$scope",function(o){}]);
Booking.controller("guestController",["DataService","$state","$scope",function(o,t,e){e.formData={},e.payment=function(){var a={};a.id="guestinfo",a.customerProfile=e.formData,o.save(a),t.go("payment")}}]);
Booking.controller("HeaderController",["$scope",function(o){}]);
Booking.controller("HomeController",["CompanyService",function(o){this.company=null,this.data="Booking Home";var n=this;o.data(function(o){n.company=o,console.log(o)})}]);
Booking.controller("InventoryController",["$rootScope","InventoryService",function(t,o){this.results=o.results,t.$on("query:results",function(){this.results=o.results}.bind(this))}]);
Booking.controller("LeftNavController",["$scope",function(o){}]);
Booking.controller("LoginController",["$rootScope","$scope","$location","LoginService",function(o,n,t,i){n.submit=function(){i.auth(n.user,function(n,i){200===i&&(o.loggedIn=n,t.path("/"))})}}]);
Booking.controller("LogoutController",["$location","LoginService",function(o,n){n.logout(),o.path("/login")}]);
Booking.controller("paymentController",["DataService","$state","$scope",function(o,t,a){a.formData={},a.gotoConfirm=function(){var n={};n.id="paymentinfo",n.paymentDetails=a.formData,o.save(n),t.go("Confirmation")}}]);
Booking.controller("PoliciesController",["$rootScope","$scope","$location",function(o,i,c){i.policies=function(o){return policies.show=!0}}]);
Booking.controller("ResController",["$scope",function(o){}]);
Booking.controller("ReservationController",["ReservationService",function(o){this.reservation=null,this.data="Booking Rerservation";var e=this;RoleService.data(function(o){e.reservation=o,console.log(o)})}]);
Booking.controller("ReserveController",["$scope","$stateParams","$state","ReservationService","DataService","$anchorScroll","$location",function(o,r,a,e,t,m,s){s.hash("top"),m(),o.formData={},o.formData.roomDetails=angular.fromJson(atob(r.roomdetails)),console.log(o.formData.roomDetails),o.summary={},o.summary.noRooms=o.formData.roomDetails.selectedrooms.length,o.summary.noGuest=o.formData.roomDetails.querry.adults,o.summary.startdate=o.formData.roomDetails.querry.check_in,o.summary.enddate=o.formData.roomDetails.querry.check_out,o.totalprice=function(){for(var r=0,a=0;a<o.summary.noRooms;a++)r+=o.formData.roomDetails.selectedrooms[a].room.base_price;return r},o.summary.tPrice=o.totalprice(),o.processForm=function(){e.create(o.formData).success(function(r){alert("data saved Reservation ID 9889"),o.formData=""}).error(function(o){alert("Errror "+o.message)})},o.proceed=function(){var r={};r.id="roominfo",r.roomdetails=o.formData,r.summary=o.summary,t.save(r),a.go("guestinfo")}}]);
Booking.controller("ReservePaymentController",["ReservationService",function(e){}]);
Booking.controller("bookingController",["ReservationService",function(o){}]);
Booking.controller("RoleController",["RoleService",function(o){this.role=null,this.data="Booking User Role";var l=this;o.data(function(o){l.role=o,console.log(o)})}]);
Booking.controller("UsersController",["UsersService",function(s){this.users=null,this.data="Booking Users";var o=this;s.data(function(s){o.users=s,console.log(s)})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbXBhbnkuanMiLCJjdXN0b21lci5qcyIsIkRhdGFTZXJ2aWNlLmpzIiwiaW52ZW50b3J5LmpzIiwibG9naW4uanMiLCJwb2xpY2llcy5qcyIsInJlc2VydmF0aW9uLmpzIiwicm9sZS5qcyIsInVzZXJzLmpzIiwiYXZhaWxhYmlsaXR5LmpzIiwiZm9vdGVyX25hdi5qcyIsImhvbWUuanMiLCJsZWZ0X25hdi5qcyIsInF1ZXJ5LmpzIiwicmV6X25hdi5qcyIsInRvcF9uYXYuanMiLCJ1c2VyX3Byb2ZpbGUuanMiLCJjb25maXJtYXRpb25Db250cm9sbGVyLmpzIiwiZm9vdGVyLmpzIiwiZ3Vlc3RDb250cm9sbGVyLmpzIiwiaGVhZGVyLmpzIiwibG9nb3V0LmpzIiwicGF5bWVudENvbnRyb2xsZXIuanMiLCJyZXMtaGVhZGVyLmpzIiwiUmVzZXJ2ZUNvbnRyb2xsZXIuanMiLCJSZXNlcnZlUGF5bWVudENvbnRyb2xsZXIuanMiLCJSZXNlcnZlUHJvZmlsZUNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiQm9va2luZyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIm90aGVyd2lzZSIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiZmFjdG9yeSIsIiRodHRwIiwiZGF0YSIsImNhbGxiYWNrIiwiZ2V0Iiwic3VjY2VzcyIsInN0YXR1cyIsInNlcnZpY2UiLCJ0aGlzIiwic2F2ZSIsImR0IiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJjb21wYW55X2lkIiwicmVzdWx0cyIsInF1ZXJ5IiwicG9zdCIsImJpbmQiLCIkY29va2llcyIsIiRyb290U2NvcGUiLCJhdXRoIiwiY3JlZGVudGlhbHMiLCJwdXQiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyb3IiLCJ1c2VyIiwibG9nZ2VkSW4iLCJwYXJzZSIsImxvZ291dCIsInJlbW92ZSIsInJlc2VydmF0aW9uIiwicXVlcnJ5IiwiY3JlYXRlIiwiZGlyZWN0aXZlIiwiZGF0ZUZpbHRlciIsInJlc3RyaWN0IiwiJHNjb3BlIiwiJGxvY2F0aW9uIiwiUmVzZXJ2YXRpb25TZXJ2aWNlIiwiJHN0YXRlUGFyYW1zIiwiRGF0YVNlcnZpY2UiLCJzZWxlY3RlZHJvb21zIiwibnVtYmVyIiwiZnJvbUpzb24iLCJhdG9iIiwic2VsZWN0cm9vbSIsImluZGV4Iiwicm9vbSIsInJtIiwiaWQiLCJzZWxlY3RlZCIsInJlbW92ZXJvb20iLCJpIiwic3BsaWNlIiwiYm9vayIsImsiLCJjb21wYW55aWQiLCJkZXQiLCJidG9hIiwidG9Kc29uIiwicGF0aCIsInN1Ym1pdCIsImFsZXJ0IiwibWVzc2FnZSIsInNjb3BlIiwidHJhbnNjbHVkZSIsIkludmVudG9yeVNlcnZpY2UiLCJtYXhfYWR1bHRzIiwibWF4X2NoaWxkcyIsImFkdWx0cyIsImNoaWxkcyIsImNoZWNrX2luIiwibW9tZW50IiwidG9EYXRlIiwiY2hlY2tfb3V0IiwiYWRkIiwiJGJyb2FkY2FzdCIsIiRzdGF0ZSIsImZvcm1EYXRhIiwiZ3Vlc3RpbmZvIiwiXyIsImZpbmRXaGVyZSIsImN1c3RvbWVyUHJvZmlsZSIsImNhcmRpbmZvIiwicGF5bWVudERldGFpbHMiLCJib29raW5naW5mbyIsImd1ZXN0U3VtbWFyeSIsInJvb21zU3VtbWFyeSIsInN1bW1hcnkiLCJwcm9jZXNzRm9ybSIsInJvb21TdW1tYXJ5IiwicmVzcCIsIlVzZXJzU2VydmljZSIsImN1c3RvbWVyIiwiX3NlbGYiLCJDdXN0b21lclNlcnZpY2UiLCJwYXltZW50IiwiZ28iLCJDb21wYW55U2VydmljZSIsImNvbXBhbnkiLCIkb24iLCJMb2dpblNlcnZpY2UiLCJnb3RvQ29uZmlybSIsInBvbGljaWVzIiwic2hvdyIsIlJvbGVTZXJ2aWNlIiwiJGFuY2hvclNjcm9sbCIsImhhc2giLCJyb29tRGV0YWlscyIsInJvb21kZXRhaWxzIiwibm9Sb29tcyIsImxlbmd0aCIsIm5vR3Vlc3QiLCJzdGFydGRhdGUiLCJlbmRkYXRlIiwidG90YWxwcmljZSIsInRwcmljZSIsImJhc2VfcHJpY2UiLCJ0UHJpY2UiLCJwcm9jZWVkIiwicm9sZSIsInVzZXJzIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxRQUVKQSxTQUFVQyxRQUFRQyxPQUFPLFdBQVksWUFBWSxZQUFZLDBDQUU3REYsUUFBUUcsUUFBUSxpQkFBa0IscUJBQXNCLFNBQVNDLEVBQWdCQyxHQUVqRkEsRUFBbUJDLFVBQVUsU0FFekJGLEVBQ0lHLE1BQU0sUUFDSEMsSUFBSyxRQUNKQyxZQUFhLDhCQUNiQyxXQUFZLG1CQUVoQkgsTUFBTSxXQUNIQyxJQUFLLG1CQUNKQyxZQUFhLDRCQUdoQkYsTUFBTSxXQUNKQyxJQUFLLHdCQUNKQyxZQUFhLGdDQUNiQyxXQUFZLHNCQUVmSCxNQUFNLFdBQ0hDLElBQUssV0FDTEMsWUFBYSxnQ0FDYkMsV0FBWSxzQkFFZkgsTUFBTSxnQkFDSEMsSUFBSyxnQkFDTEMsWUFBYSw0Q0FDYkMsV0FBWSwyQkFHZkgsTUFBTSxhQUNIQyxJQUFLLGFBQ0xDLFlBQWEsZ0NBQ2JDLFdBQVk7QUN0Q3hCVixRQUFRVyxRQUFRLGtCQUFtQixRQUFTLFNBQVNDLEdBQ25ELE9BQ0VDLEtBQU8sU0FBU0MsR0FDZEYsRUFBTUcsSUFBSSxnQkFDUEMsUUFBUSxTQUFTSCxFQUFNSSxHQUN0QkgsRUFBU0Q7QUNMbkJiLFFBQVFXLFFBQVEsbUJBQW9CLFFBQVMsU0FBU0MsR0FDcEQsT0FDRUMsS0FBTyxTQUFTQyxHQUNkRixFQUFNRyxJQUFJLGlCQUNQQyxRQUFRLFNBQVNILEVBQU1JLEdBQ3RCSCxFQUFTRDtBQ0xuQmIsUUFBUWtCLFFBQVEsZUFBZ0IsUUFBUyxTQUFTTixHQUUvQyxHQUFJQyxLQUdITSxNQUFLQyxLQUFLLFNBQVNDLEdBQ2hCUixFQUFLUyxLQUFLRCxHQUNWRSxRQUFRQyxJQUFJLGNBQ1pELFFBQVFDLElBQUlYLElBR2ZNLEtBQUtKLElBQUksV0FDUixNQUFPRjtBQ1paYixRQUFRVyxRQUFRLG9CQUFxQixRQUFTLFNBQVNDLEdBQ3JELEdBQUlhLEdBQWEsS0FDakIsUUFDRUMsV0FFQWIsS0FBTSxTQUFTQyxHQUNiRixFQUFNRyxJQUFJLGtCQUNQQyxRQUFRLFNBQVNILEVBQU1JLEdBQ3RCSCxFQUFTRCxNQUdmYyxNQUFPLFNBQVNBLEVBQU9iLEdBQ3JCRixFQUFNZ0IsS0FBSyxxQkFBcUJILEVBQVlFLEdBQ3pDWCxRQUFRLFNBQVNILEVBQU1JLEdBQ3RCRSxLQUFLTyxRQUFVYixFQUNmQyxFQUFTRCxJQUNUZ0IsS0FBS1Y7QUNoQmZuQixRQUFRVyxRQUFRLGdCQUFpQixRQUFTLFdBQVksYUFBYyxTQUFTQyxFQUFPa0IsRUFBVUMsR0FDNUYsT0FDRUMsS0FBTSxTQUFTQyxFQUFhbkIsR0FDMUJGLEVBQU1nQixLQUFLLGFBQWNLLEdBQ3RCakIsUUFBUSxTQUFTSCxFQUFNSSxHQUN0QmEsRUFBU0ksSUFBSSxPQUFRQyxLQUFLQyxVQUFVdkIsSUFDcENDLEVBQVNELEVBQU1JLEtBRWhCb0IsTUFBTSxXQUNMZCxRQUFRQyxJQUFJLFlBSWxCYyxLQUFNLFdBQ0osR0FBSUEsR0FBTyxJQUlYLE9BSElSLEdBQVNmLElBQUksVUFDZmdCLEVBQVdRLFNBQVdELEVBQU9ILEtBQUtLLE1BQU1WLEVBQVNmLElBQUksVUFFaER1QixHQUdURyxPQUFRLFdBQ05WLEVBQVdRLFNBQVcsS0FDdEJULEVBQVNZLE9BQU87QUN2QnRCMUMsUUFBUVcsUUFBUSxtQkFBb0IsUUFBUyxTQUFTQyxHQUNwRCxPQUNFQyxLQUFPLFNBQVNDLEdBQ2RGLEVBQU1HLElBQUksaUJBQ1BDLFFBQVEsU0FBU0gsRUFBTUksR0FDdEJILEVBQVNEO0FDTG5CYixRQUFRVyxRQUFRLHNCQUF1QixRQUFTLFNBQVNDLEdBQ3BELEdBQUkrQixLQWdCSixPQWRFQSxHQUFZOUIsS0FBSyxXQUNkLE1BQVFELEdBQU1HLElBQUkscUJBSXJCNEIsRUFBWWhCLE1BQU0sU0FBU2lCLEdBQ3ZCLE1BQVFoQyxHQUFNRyxJQUFJLHFCQUd0QjRCLEVBQVlFLE9BQU8sU0FBU2hDLEdBQ3hCLE1BQVFELEdBQU1nQixLQUFLLG1CQUFtQmYsSUFJckM4QjtBQ2pCWjNDLFFBQVFXLFFBQVEsZUFBZ0IsUUFBUyxTQUFTQyxHQUNoRCxPQUNFQyxLQUFPLFNBQVNDLEdBQ2RGLEVBQU1HLElBQUksYUFDUEMsUUFBUSxTQUFTSCxFQUFNSSxHQUN0QkgsRUFBU0Q7QUNMbkJiLFFBQVFXLFFBQVEsZ0JBQWlCLFFBQVMsU0FBU0MsR0FDakQsT0FDRUMsS0FBTyxTQUFTQyxHQUNkRixFQUFNRyxJQUFJLGNBQ1BDLFFBQVEsU0FBU0gsRUFBTUksR0FDdEJILEVBQVNEO0FDTG5CYixRQUFROEMsVUFBVSxnQkFBaUIsYUFBYyxhQUFjLFNBQVNmLEVBQVlnQixHQUNsRixPQUNFQyxTQUFjLElBQ2R2QyxZQUFjLDBDQUNkQyxZQUFlLFNBQVMsWUFBWSxxQkFBcUIsZUFBZSxjQUFlLFNBQVN1QyxFQUFPQyxFQUFVQyxFQUFtQkMsRUFBYUMsR0FFL0lKLEVBQU9LLGlCQUNQTCxFQUFPTSxPQUFPLEdBQ2xCTixFQUFPTCxPQUFRM0MsUUFBUXVELFNBQVNDLEtBQUtMLEVBQWFSLFNBR3BESyxFQUFPUyxXQUFXLFNBQVNDLEVBQU1DLEdBQzlCLEdBQUlDLEtBQ0hBLEdBQUdDLEdBQUdILEVBQ05FLEVBQUdELEtBQUtBLEVBQ1JBLEVBQUtHLFVBQVMsRUFDZGQsRUFBT0ssY0FBY2hDLEtBQUt1QyxHQUMxQlosRUFBT00sT0FBT0ksRUFDZHBDLFFBQVFDLElBQUl5QixFQUFPSyxnQkFFdkJMLEVBQU9lLFdBQVcsU0FBU0wsR0FFeEIsSUFBS00sSUFBS2hCLEdBQU9LLGNBQ0pMLEVBQU9LLGNBQWNXLEdBQUdILElBQU1ILEdBQzlCVixFQUFPSyxjQUFjWSxPQUFPRCxFQUFHLElBSy9DaEIsRUFBT2tCLEtBQUssV0FDVixHQUFJQyxLQUNEQSxHQUFFZCxjQUFjTCxFQUFPSyxjQUN2QmMsRUFBRXhCLE9BQU9LLEVBQU9MLE9BQ2hCd0IsRUFBRUMsVUFBVXBCLEVBQU9LLGNBQWMsR0FBR00sS0FBS25DLFdBQ3pDMkMsRUFBRU4sR0FBRyxhQUNQLElBQUlRLEdBQUlDLEtBQUt0RSxRQUFRdUUsT0FBT0osR0FDNUJmLEdBQVlqQyxLQUFLZ0QsR0FDbEJsQixFQUFVdUIsS0FBSyxZQUFZSCxJQUl2QnJCLEVBQU95QixPQUFTLFdBQ2J2QixFQUFtQnhCLE1BQU1zQixFQUFPdEIsT0FDMUJYLFFBQVEsU0FBVUgsTUFNcEJ3QixNQUFNLFNBQVVBLEdBQ2JzQyxNQUFNLFVBQVV0QyxFQUFNdUM7QUNsRHRDNUUsUUFBUThDLFVBQVUsYUFBYyxXQUM5QixPQUNFRSxTQUFjLElBQ2Q2QixTQUNBQyxZQUFjLEVBQ2RyRSxZQUFjLG9DQUNkQyxXQUFjO0FDTmxCVixRQUFROEMsVUFBVSxRQUFTLFdBQ3pCLE9BQ0VFLFNBQWMsSUFDZHZDLFlBQWM7QVJIbEJULFFBQVE4QyxVQUFVLGFBQWMsV0FDOUIsT0FDRUUsU0FBYyxJQUNkdkMsWUFBYztBU0hsQlQsUUFBUThDLFVBQVUsV0FBWSxXQUM1QixPQUNFRSxTQUFjLElBQ2Q2QixTQUNBQyxZQUFjLEVBQ2RyRSxZQUFjLHNDQUNkQyxXQUFjO0FSTmxCVixRQUFROEMsVUFBVSxTQUFVLFdBQzFCLE9BQ0VFLFNBQWMsSUFDZDZCLFNBQ0FDLFlBQWMsRUFDZHJFLFlBQWMsbUNBQ2RDLFdBQWM7QUNObEJWLFFBQVE4QyxVQUFVLFlBQWEsV0FDN0IsT0FDRUUsU0FBYyxJQUNkNkIsU0FDQUMsWUFBYyxFQUNkckUsWUFBYyxzQ0FDZEMsV0FBYTtBUU5qQlYsUUFBUThDLFVBQVUsU0FBVSxhQUFjLGFBQWEsWUFBYSxTQUFTZixFQUFZZ0IsRUFBV0csR0FDbEcsT0FDRUYsU0FBYyxJQUNkdkMsWUFBYyxtQ0FDZEMsWUFBZSxTQUFVLG1CQUFvQixTQUFTdUMsRUFBUThCLEdBQzVEOUIsRUFBTytCLFlBQWMsRUFBRSxFQUFFLEdBQ3pCL0IsRUFBT2dDLFlBQWMsRUFBRSxFQUFFLEVBQUUsR0FDM0JoQyxFQUFPdEIsT0FDTHVELE9BQVEsRUFDUkMsT0FBUSxFQUNSQyxVQUFVLEdBQUlDLFNBQVNDLFNBQ3ZCQyxXQUFXLEdBQUlGLFNBQVNHLElBQUksRUFBRyxRQUFRRixVQUd6Q3JDLEVBQU95QixPQUFTLFdBQ2RLLEVBQWlCcEQsTUFBTXNCLEVBQU90QixNQUFPLFNBQVNELEdBQzVDSyxFQUFXMEQsV0FBVyxrQkFFbkIsSUFBSW5CLEdBQUlDLEtBQUt0RSxRQUFRdUUsT0FBT3ZCLEVBQU90QixPQUN0Q3VCLEdBQVV1QixLQUFLLFlBQVlIO0FDbkJyQ3RFLFFBQVE4QyxVQUFVLFVBQVcsV0FDM0IsT0FDRUUsU0FBYyxJQUNkNkIsU0FDQUMsWUFBYyxFQUNkckUsWUFBYyxxQ0FDZEMsV0FBYztBQ05sQlYsUUFBUThDLFVBQVUsVUFBVyxXQUMzQixPQUNFRSxTQUFjLElBQ2Q2QixTQUNBQyxZQUFjLEVBQ2RyRSxZQUFjLG9DQUNkQyxXQUFjO0FQTmxCVixRQUFROEMsVUFBVSxTQUFVLFdBQzFCLE9BQ0VFLFNBQWMsSUFDZHZDLFlBQWM7QVFIbEJULFFBQVE4QyxVQUFVLGdCQUFpQixXQUNqQyxPQUNFRSxTQUFjLElBQ2R2QyxZQUFjO0FDSGxCVCxRQUFRVSxXQUFXLDBCQUEyQixjQUFjLFNBQVMsU0FBUyxxQkFBc0IsU0FBUzJDLEVBQVlxQyxFQUFPekMsRUFBT0UsR0FDcElGLEVBQU8wQyxTQUFTdEMsRUFBWXRDLE1BQzVCa0MsRUFBTzJDLFVBQVdDLEVBQUVDLFVBQVU3QyxFQUFPMEMsVUFBVzdCLEdBQUcsY0FBY2lDLGdCQUNqRTlDLEVBQU8rQyxTQUFTSCxFQUFFQyxVQUFVN0MsRUFBTzBDLFVBQVc3QixHQUFHLGdCQUFnQm1DLGVBQ2pFaEQsRUFBT2lELFlBQVlMLEVBQUVDLFVBQVU3QyxFQUFPMEMsVUFBVzdCLEdBQUcsZ0JBQWdCUixjQUNuRUwsRUFBT2tELGFBQWFOLEVBQUVDLFVBQVU3QyxFQUFPMEMsVUFBVzdCLEdBQUcsZ0JBQWdCbEIsT0FDckVLLEVBQU9tRCxhQUFhUCxFQUFFQyxVQUFVN0MsRUFBTzBDLFVBQVc3QixHQUFHLGFBQWF1QyxRQUNuRXBELEVBQU94QixXQUFXb0UsRUFBRUMsVUFBVTdDLEVBQU8wQyxVQUFXN0IsR0FBRyxnQkFBZ0JPLFVBSW5FcEIsRUFBT3FELFlBQVksV0FDbEIsR0FBSXpGLEtBQ0FBLEdBQUsrRSxVQUFVM0MsRUFBTzJDLFVBQ3RCL0UsRUFBS21GLFNBQVMvQyxFQUFPK0MsU0FDckJuRixFQUFLcUYsWUFBWWpELEVBQU9pRCxZQUN2QnJGLEVBQUtzRixhQUFhbEQsRUFBT2tELGFBQ3pCdEYsRUFBSzBGLFlBQVl0RCxFQUFPbUQsYUFDeEJ2RixFQUFLWSxXQUFXd0IsRUFBT3hCLFdBRzNCMEIsRUFBbUJOLE9BQU9oQyxHQUN0QkcsUUFBUSxTQUFVd0YsR0FDWDdCLE1BQU02QixHQUNOakYsUUFBUUMsSUFBSWdGLEdBQ1p2RCxFQUFPMEMsU0FBUyxLQUluQnRELE1BQU0sU0FBVW1FLEdBQ2I3QixNQUFNLFVBQVU2QjtBaEI5QmhDeEcsUUFBUVUsV0FBVyxzQkFBdUIsa0JBQW1CLFNBQVMrRixHQUNwRXRGLEtBQUt1RixTQUFXLEtBQ2hCdkYsS0FBS04sS0FBTyxrQkFDWixJQUFJOEYsR0FBUXhGLElBRVp5RixpQkFBZ0IvRixLQUFLLFNBQVNBLEdBQzVCOEYsRUFBTUQsU0FBVzdGLEVBQ2pCVSxRQUFRQyxJQUFJWDtBaUJQaEJiLFFBQVFVLFdBQVcsb0JBQXFCLFNBQVUsU0FBU3VDO0FDQTNEakQsUUFBUVUsV0FBVyxtQkFBb0IsY0FBYyxTQUFTLFNBQVUsU0FBUzJDLEVBQVlxQyxFQUFPekMsR0FDakdBLEVBQU8wQyxZQUdQMUMsRUFBTzRELFFBQVEsV0FFWixHQUFJaEcsS0FDSkEsR0FBS2lELEdBQUcsWUFDUmpELEVBQUtrRixnQkFBZ0I5QyxFQUFPMEMsU0FDN0J0QyxFQUFZakMsS0FBS1AsR0FDakI2RSxFQUFPb0IsR0FBRztBQ1ZmOUcsUUFBUVUsV0FBVyxvQkFBcUIsU0FBVSxTQUFTdUM7QVRBM0RqRCxRQUFRVSxXQUFXLGtCQUFtQixpQkFBa0IsU0FBU3FHLEdBQy9ENUYsS0FBSzZGLFFBQVUsS0FDZjdGLEtBQUtOLEtBQU8sY0FDWixJQUFJOEYsR0FBUXhGLElBRVo0RixHQUFlbEcsS0FBSyxTQUFTQSxHQUMzQjhGLEVBQU1LLFFBQVVuRyxFQUNoQlUsUUFBUUMsSUFBSVg7QVJQaEJiLFFBQVFVLFdBQVcsdUJBQXdCLGFBQWMsbUJBQW9CLFNBQVNxQixFQUFZZ0QsR0FDaEc1RCxLQUFLTyxRQUFVcUQsRUFBaUJyRCxRQUVoQ0ssRUFBV2tGLElBQUksZ0JBQWlCLFdBQzlCOUYsS0FBS08sUUFBVXFELEVBQWlCckQsU0FDaENHLEtBQUtWO0FTTFRuQixRQUFRVSxXQUFXLHFCQUFzQixTQUFVLFNBQVN1QztBUkE1RGpELFFBQVFVLFdBQVcsbUJBQW9CLGFBQWMsU0FBVSxZQUFhLGVBQzFFLFNBQVNxQixFQUFZa0IsRUFBUUMsRUFBV2dFLEdBQ3RDakUsRUFBT3lCLE9BQVMsV0FDZHdDLEVBQWFsRixLQUFLaUIsRUFBT1gsS0FBTSxTQUFTekIsRUFBTUksR0FDN0IsTUFBWEEsSUFDRmMsRUFBV1EsU0FBVzFCLEVBQ3RCcUMsRUFBVXVCLEtBQUs7QWlCTnpCekUsUUFBUVUsV0FBVyxvQkFBcUIsWUFBYSxlQUFnQixTQUFTd0MsRUFBV2dFLEdBQ3ZGQSxFQUFhekUsU0FDYlMsRUFBVXVCLEtBQUs7QUNGakJ6RSxRQUFRVSxXQUFXLHFCQUFzQixjQUFjLFNBQVMsU0FBVSxTQUFTMkMsRUFBWXFDLEVBQU96QyxHQUNuR0EsRUFBTzBDLFlBR1AxQyxFQUFPa0UsWUFBWSxXQUNoQixHQUFJdEcsS0FDSkEsR0FBS2lELEdBQUcsY0FDUmpELEVBQUtvRixlQUFlaEQsRUFBTzBDLFNBQzVCdEMsRUFBWWpDLEtBQUtQLEdBQ2pCNkUsRUFBT29CLEdBQUc7QWpCVGY5RyxRQUFRVSxXQUFXLHNCQUF1QixhQUFjLFNBQVUsWUFBYSxTQUFTcUIsRUFBWWtCLEVBQVFDLEdBQ3hHRCxFQUFPbUUsU0FBVyxTQUFTQyxHQUN6QixNQUFPRCxVQUFTQyxNQUFPO0FrQkY3QnJILFFBQVFVLFdBQVcsaUJBQWtCLFNBQVUsU0FBU3VDO0FqQkF4RGpELFFBQVFVLFdBQVcseUJBQTBCLHFCQUFzQixTQUFTeUMsR0FDMUVoQyxLQUFLd0IsWUFBYyxLQUNuQnhCLEtBQUtOLEtBQU8sc0JBQ1osSUFBSThGLEdBQVF4RixJQUVabUcsYUFBWXpHLEtBQUssU0FBU0EsR0FDeEI4RixFQUFNaEUsWUFBYzlCLEVBQ3BCVSxRQUFRQyxJQUFJWDtBa0JQaEJiLFFBQVFVLFdBQVcscUJBQXNCLFNBQVMsZUFBZSxTQUFTLHFCQUFzQixjQUFjLGdCQUFnQixZQUFZLFNBQVN1QyxFQUFPRyxFQUFhc0MsRUFBT3ZDLEVBQW1CRSxFQUFZa0UsRUFBY3JFLEdBQ3hOQSxFQUFVc0UsS0FBSyxPQUdaRCxJQUdKdEUsRUFBTzBDLFlBQ1IxQyxFQUFPMEMsU0FBUzhCLFlBQVl4SCxRQUFRdUQsU0FBU0MsS0FBS0wsRUFBYXNFLGNBQzlEbkcsUUFBUUMsSUFBSXlCLEVBQU8wQyxTQUFTOEIsYUFFNUJ4RSxFQUFPb0QsV0FDUHBELEVBQU9vRCxRQUFRc0IsUUFBUTFFLEVBQU8wQyxTQUFTOEIsWUFBWW5FLGNBQWNzRSxPQUNqRTNFLEVBQU9vRCxRQUFRd0IsUUFBUzVFLEVBQU8wQyxTQUFTOEIsWUFBWTdFLE9BQU9zQyxPQUMzRGpDLEVBQU9vRCxRQUFReUIsVUFBVTdFLEVBQU8wQyxTQUFTOEIsWUFBWTdFLE9BQU93QyxTQUM1RG5DLEVBQU9vRCxRQUFRMEIsUUFBUTlFLEVBQU8wQyxTQUFTOEIsWUFBWTdFLE9BQU8yQyxVQUUxRHRDLEVBQU8rRSxXQUFXLFdBSWIsSUFBSyxHQUhBQyxHQUFPLEVBR0hoRSxFQUFFLEVBQUlBLEVBQUVoQixFQUFPb0QsUUFBUXNCLFFBQVExRCxJQUVwQ2dFLEdBQWNoRixFQUFPMEMsU0FBUzhCLFlBQVluRSxjQUFjVyxHQUFHTCxLQUFLc0UsVUFFbkUsT0FBT0QsSUFLZmhGLEVBQU9vRCxRQUFROEIsT0FBUWxGLEVBQU8rRSxhQUkxQi9FLEVBQU9xRCxZQUFjLFdBR2ZuRCxFQUFtQk4sT0FBT0ksRUFBTzBDLFVBQzVCM0UsUUFBUSxTQUFVSCxHQUNqQjhELE1BQU0sa0NBQ04xQixFQUFPMEMsU0FBUyxLQUduQnRELE1BQU0sU0FBVUEsR0FDYnNDLE1BQU0sVUFBVXRDLEVBQU11QyxZQU9sQzNCLEVBQU9tRixRQUFRLFdBQ2IsR0FBSXZILEtBQ0ZBLEdBQUtpRCxHQUFHLFdBQ1JqRCxFQUFLNkcsWUFBWXpFLEVBQU8wQyxTQUN4QjlFLEVBQUt3RixRQUFRcEQsRUFBT29ELFFBQ25CaEQsRUFBWWpDLEtBQUtQLEdBQ2Y2RSxFQUFPb0IsR0FBRztBQ3pEckI5RyxRQUFRVSxXQUFXLDRCQUE2QixxQkFBc0IsU0FBU3lDO0FDQS9FbkQsUUFBUVUsV0FBVyxxQkFBc0IscUJBQXNCLFNBQVN5QztBbkJBeEVuRCxRQUFRVSxXQUFXLGtCQUFtQixjQUFlLFNBQVM0RyxHQUM1RG5HLEtBQUtrSCxLQUFPLEtBQ1psSCxLQUFLTixLQUFPLG1CQUNaLElBQUk4RixHQUFReEYsSUFFWm1HLEdBQVl6RyxLQUFLLFNBQVNBLEdBQ3hCOEYsRUFBTTBCLEtBQU94SCxFQUNiVSxRQUFRQyxJQUFJWDtBQ1BoQmIsUUFBUVUsV0FBVyxtQkFBb0IsZUFBZ0IsU0FBUytGLEdBQzlEdEYsS0FBS21ILE1BQVEsS0FDYm5ILEtBQUtOLEtBQU8sZUFDWixJQUFJOEYsR0FBUXhGLElBRVpzRixHQUFhNUYsS0FBSyxTQUFTQSxHQUN6QjhGLEVBQU0yQixNQUFRekgsRUFDZFUsUUFBUUMsSUFBSVgiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIEJvb2tpbmc7XG5cbkJvb2tpbmcgPSBhbmd1bGFyLm1vZHVsZSgnQm9va2luZycsIFsnbmdDb29raWVzJywndWkucm91dGVyJywnYW5ndWxhclV0aWxzLmRpcmVjdGl2ZXMuZGlyUGFnaW5hdGlvbiddKTtcblxuQm9va2luZy5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKXtcbiBcbiR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XG4gXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgICAgIHVybDogJy9ob21lJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy92aWV3cy9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAuc3RhdGUoJ2Jvb2tpbmcnLCB7XG4gICAgICAgICAgIHVybDogJy9ib29raW5nLzpxdWVycnknLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2Jvb2tpbmcuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICBcbiAgICAgICAgLnN0YXRlKCdyZXNlcnZlJywge1xuICAgICAgICAgICB1cmw6ICcvcmVzZXJ2ZS86cm9vbWRldGFpbHMnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3ZpZXdzL3Jlc2VydmUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUmVzZXJ2ZUNvbnRyb2xsZXInXG4gICAgICAgIH0pIFxuICAgICAgICAuc3RhdGUoJ3BheW1lbnQnLCB7XG4gICAgICAgICAgICB1cmw6ICcvcGF5bWVudCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvdmlld3MvcGF5bWVudC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwYXltZW50Q29udHJvbGxlcidcbiAgICAgICAgfSlcbiAgICAgICAgLnN0YXRlKCdDb25maXJtYXRpb24nLCB7XG4gICAgICAgICAgICB1cmw6ICcvQ29uZmlybWF0aW9uJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy92aWV3cy9wYXltZW50Q29uZmlybWF0aW9uLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NvbmZpcm1hdGlvbkNvbnRyb2xsZXInXG5cbiAgICAgICAgfSlcbiAgICAgICAgLnN0YXRlKCdndWVzdGluZm8nLCB7XG4gICAgICAgICAgICB1cmw6ICcvZ3Vlc3RpbmZvJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy92aWV3cy9wcm9maWxlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2d1ZXN0Q29udHJvbGxlcidcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBcblxuICAgICAgICBcbiAgICAgICBcblxuXG59XSk7XG5cbiIsIkJvb2tpbmcuZmFjdG9yeSgnQ29tcGFueVNlcnZpY2UnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApe1xuICByZXR1cm4ge1xuICAgIGRhdGEgOiBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgJGh0dHAuZ2V0KCcvYXBpL2NvbXBhbnknKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpe1xuICAgICAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH07XG5cbn1dKTtcbiIsIkJvb2tpbmcuY29udHJvbGxlcignQ3VzdG9tZXJDb250cm9sbGVyJywgWydDdXN0b21lclNlcnZpY2UnLCBmdW5jdGlvbihVc2Vyc1NlcnZpY2Upe1xuICB0aGlzLmN1c3RvbWVyID0gbnVsbDtcbiAgdGhpcy5kYXRhID0gJ0Jvb2tpbmcgQ3VzdG9tZXInO1xuICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gIEN1c3RvbWVyU2VydmljZS5kYXRhKGZ1bmN0aW9uKGRhdGEpe1xuICAgIF9zZWxmLmN1c3RvbWVyID0gZGF0YTtcbiAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgfSk7XG59XSk7IiwiQm9va2luZy5zZXJ2aWNlKCdEYXRhU2VydmljZScsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCl7XHJcblxyXG5cdCAgdmFyIGRhdGE9W11cclxuXHJcblxyXG5cdCAgIHRoaXMuc2F2ZT1mdW5jdGlvbihkdCl7XHJcblx0ICAgICBcdGRhdGEucHVzaChkdCk7XHJcblx0ICAgICBcdGNvbnNvbGUubG9nKFwiZGF0YSBTYXZlZFwiKTtcclxuXHQgICAgIFx0Y29uc29sZS5sb2coZGF0YSk7XHJcblxyXG5cdCAgIH1cclxuXHQgICB0aGlzLmdldD1mdW5jdGlvbigpe1xyXG5cdCAgIFx0cmV0dXJuIGRhdGE7XHJcblx0ICAgfVxyXG5cclxuICAgICBcclxufV0pOyIsIkJvb2tpbmcuY29udHJvbGxlcignSW52ZW50b3J5Q29udHJvbGxlcicsIFsnJHJvb3RTY29wZScsICdJbnZlbnRvcnlTZXJ2aWNlJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgSW52ZW50b3J5U2VydmljZSl7XG4gIHRoaXMucmVzdWx0cyA9IEludmVudG9yeVNlcnZpY2UucmVzdWx0cztcblxuICAkcm9vdFNjb3BlLiRvbigncXVlcnk6cmVzdWx0cycsIGZ1bmN0aW9uKCl7XG4gICAgdGhpcy5yZXN1bHRzID0gSW52ZW50b3J5U2VydmljZS5yZXN1bHRzO1xuICB9LmJpbmQodGhpcykpO1xuXG5cblxufV0pO1xuIiwiQm9va2luZy5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRsb2NhdGlvbicsICdMb2dpblNlcnZpY2UnLFxuICBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRsb2NhdGlvbiwgTG9naW5TZXJ2aWNlKXtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgIExvZ2luU2VydmljZS5hdXRoKCRzY29wZS51c2VyLCBmdW5jdGlvbihkYXRhLCBzdGF0dXMpe1xuICAgICAgICBpZiAoc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAkcm9vdFNjb3BlLmxvZ2dlZEluID0gZGF0YTtcbiAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gIH1dXG4pO1xuXG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ1BvbGljaWVzQ29udHJvbGxlcicsIFsnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkbG9jYXRpb24pe1xuICAgICRzY29wZS5wb2xpY2llcyA9IGZ1bmN0aW9uKHNob3cpIHtcbiAgICAgIHJldHVybiBwb2xpY2llcy5zaG93ID0gdHJ1ZTsgIFxuICAgIH07XG4gIH1cbl0pO1xuXG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ1Jlc2VydmF0aW9uQ29udHJvbGxlcicsIFsnUmVzZXJ2YXRpb25TZXJ2aWNlJywgZnVuY3Rpb24oUmVzZXJ2YXRpb25TZXJ2aWNlKXtcbiAgdGhpcy5yZXNlcnZhdGlvbiA9IG51bGw7XG4gIHRoaXMuZGF0YSA9ICdCb29raW5nIFJlcnNlcnZhdGlvbic7XG4gIHZhciBfc2VsZiA9IHRoaXM7XG5cbiAgUm9sZVNlcnZpY2UuZGF0YShmdW5jdGlvbihkYXRhKXtcbiAgICBfc2VsZi5yZXNlcnZhdGlvbiA9IGRhdGE7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG4gIH0pO1xufV0pOyIsIkJvb2tpbmcuY29udHJvbGxlcignUm9sZUNvbnRyb2xsZXInLCBbJ1JvbGVTZXJ2aWNlJywgZnVuY3Rpb24oUm9sZVNlcnZpY2Upe1xuICB0aGlzLnJvbGUgPSBudWxsO1xuICB0aGlzLmRhdGEgPSAnQm9va2luZyBVc2VyIFJvbGUnO1xuICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gIFJvbGVTZXJ2aWNlLmRhdGEoZnVuY3Rpb24oZGF0YSl7XG4gICAgX3NlbGYucm9sZSA9IGRhdGE7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG4gIH0pO1xufV0pOyIsIkJvb2tpbmcuY29udHJvbGxlcignVXNlcnNDb250cm9sbGVyJywgWydVc2Vyc1NlcnZpY2UnLCBmdW5jdGlvbihVc2Vyc1NlcnZpY2Upe1xuICB0aGlzLnVzZXJzID0gbnVsbDtcbiAgdGhpcy5kYXRhID0gJ0Jvb2tpbmcgVXNlcnMnO1xuICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gIFVzZXJzU2VydmljZS5kYXRhKGZ1bmN0aW9uKGRhdGEpe1xuICAgIF9zZWxmLnVzZXJzID0gZGF0YTtcbiAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgfSk7XG59XSk7IiwiQm9va2luZy5kaXJlY3RpdmUoJ2F2YWlsYWJpbGl0eScsIFsnJHJvb3RTY29wZScsICdkYXRlRmlsdGVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgZGF0ZUZpbHRlcil7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3QgICAgOiAnRScsXG4gICAgdGVtcGxhdGVVcmwgOiAnL3RlbXBsYXRlcy9kaXJlY3RpdmVzL2F2YWlsYWJpbGl0eS5odG1sJyxcbiAgICBjb250cm9sbGVyICA6IFsnJHNjb3BlJywnJGxvY2F0aW9uJywnUmVzZXJ2YXRpb25TZXJ2aWNlJywnJHN0YXRlUGFyYW1zJywnRGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsJGxvY2F0aW9uLFJlc2VydmF0aW9uU2VydmljZSwkc3RhdGVQYXJhbXMsRGF0YVNlcnZpY2Upe1xuICAgICAgXG4gICAgICAkc2NvcGUuc2VsZWN0ZWRyb29tcz1bXTtcbiAgICAgICRzY29wZS5udW1iZXI9LTE7XG4gICRzY29wZS5xdWVycnk9IGFuZ3VsYXIuZnJvbUpzb24oYXRvYigkc3RhdGVQYXJhbXMucXVlcnJ5KSlcbiAgICAgXG5cbiRzY29wZS5zZWxlY3Ryb29tPWZ1bmN0aW9uKGluZGV4LHJvb20pe1xuICAgdmFyIHJtPXt9O1xuICAgIHJtLmlkPWluZGV4O1xuICAgIHJtLnJvb209cm9vbTtcbiAgICByb29tLnNlbGVjdGVkPXRydWU7XG4gICAgJHNjb3BlLnNlbGVjdGVkcm9vbXMucHVzaChybSk7XG4gICAgJHNjb3BlLm51bWJlcj1pbmRleDtcbiAgICBjb25zb2xlLmxvZygkc2NvcGUuc2VsZWN0ZWRyb29tcylcbn07XG4kc2NvcGUucmVtb3Zlcm9vbT1mdW5jdGlvbihpbmRleCl7XG5cbiAgIGZvciAoaSBpbiAkc2NvcGUuc2VsZWN0ZWRyb29tcykge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZHJvb21zW2ldLmlkID09IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkcm9vbXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG59O1xuXG4kc2NvcGUuYm9vaz1mdW5jdGlvbigpe1xuICB2YXIgaz17fTtcbiAgICAgay5zZWxlY3RlZHJvb21zPSRzY29wZS5zZWxlY3RlZHJvb21zO1xuICAgICBrLnF1ZXJyeT0kc2NvcGUucXVlcnJ5O1xuICAgICBrLmNvbXBhbnlpZD0kc2NvcGUuc2VsZWN0ZWRyb29tc1swXS5yb29tLmNvbXBhbnlfaWQ7XG4gICAgIGsuaWQ9J2Jvb2tpbmdpbmZvJztcbiAgIHZhciBkZXQ9YnRvYShhbmd1bGFyLnRvSnNvbihrKSk7XG4gICBEYXRhU2VydmljZS5zYXZlKGspO1xuICAkbG9jYXRpb24ucGF0aCgnL3Jlc2VydmUvJytkZXQpO1xuICBcbn07XG5cbiAgICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAgUmVzZXJ2YXRpb25TZXJ2aWNlLnF1ZXJ5KCRzY29wZS5xdWVyeSlcbiAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBhbGVydChcIkVycnJvciBcIitlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH0pOyAgXG4gICAgICAgIFxuICAgICAgfTtcbiAgICB9XVxuICB9O1xufV0pOyIsIkJvb2tpbmcuZGlyZWN0aXZlKCdmb290ZXJOYXYnLCBbZnVuY3Rpb24oKXtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdCAgICA6ICdFJyxcbiAgICBzY29wZSAgICAgICA6IHt9LFxuICAgIHRyYW5zY2x1ZGUgIDogdHJ1ZSxcbiAgICB0ZW1wbGF0ZVVybCA6ICcvdGVtcGxhdGVzL2RpcmVjdGl2ZXMvZm9vdGVyLmh0bWwnLFxuICAgIGNvbnRyb2xsZXIgIDogJ0Zvb3RlckNvbnRyb2xsZXInXG4gIH07XG59XSk7XG5cbiIsIkJvb2tpbmcuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBbJ0NvbXBhbnlTZXJ2aWNlJywgZnVuY3Rpb24oQ29tcGFueVNlcnZpY2Upe1xuICB0aGlzLmNvbXBhbnkgPSBudWxsO1xuICB0aGlzLmRhdGEgPSAnQm9va2luZyBIb21lJztcbiAgdmFyIF9zZWxmID0gdGhpcztcblxuICBDb21wYW55U2VydmljZS5kYXRhKGZ1bmN0aW9uKGRhdGEpe1xuICAgIF9zZWxmLmNvbXBhbnkgPSBkYXRhO1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICB9KTtcblxuXG5cbn1dKTtcbiIsIkJvb2tpbmcuY29udHJvbGxlcignTGVmdE5hdkNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7XG59XSk7XG5cbiIsIkJvb2tpbmcuZGlyZWN0aXZlKCdxdWVyeScsIFsnJHJvb3RTY29wZScsICdkYXRlRmlsdGVyJywnJGxvY2F0aW9uJyAsZnVuY3Rpb24oJHJvb3RTY29wZSwgZGF0ZUZpbHRlciwkbG9jYXRpb24pe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0ICAgIDogJ0UnLFxuICAgIHRlbXBsYXRlVXJsIDogJy90ZW1wbGF0ZXMvZGlyZWN0aXZlcy9xdWVyeS5odG1sJyxcbiAgICBjb250cm9sbGVyICA6IFsnJHNjb3BlJywgJ0ludmVudG9yeVNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsIEludmVudG9yeVNlcnZpY2Upe1xuICAgICAgJHNjb3BlLm1heF9hZHVsdHMgPSBbMSwyLDNdO1xuICAgICAgJHNjb3BlLm1heF9jaGlsZHMgPSBbMCwxLDIsM107XG4gICAgICAkc2NvcGUucXVlcnkgPSB7XG4gICAgICAgIGFkdWx0czogMSxcbiAgICAgICAgY2hpbGRzOiAwLFxuICAgICAgICBjaGVja19pbjogbmV3IG1vbWVudCgpLnRvRGF0ZSgpLFxuICAgICAgICBjaGVja19vdXQ6IG5ldyBtb21lbnQoKS5hZGQoMywgJ2RheXMnKS50b0RhdGUoKVxuICAgICAgfTtcblxuICAgICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIEludmVudG9yeVNlcnZpY2UucXVlcnkoJHNjb3BlLnF1ZXJ5LCBmdW5jdGlvbihyZXN1bHRzKXtcbiAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3F1ZXJ5OnJlc3VsdHMnKTtcbiAgICAgICAgfSk7XG4gICAgICAgICAgICAgdmFyIGRldD1idG9hKGFuZ3VsYXIudG9Kc29uKCRzY29wZS5xdWVyeSkpO1xuICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvYm9va2luZy8nK2RldCk7XG4gICAgICB9XG4gICAgfV1cbiAgfTtcbn1dKTtcblxuIiwiQm9va2luZy5kaXJlY3RpdmUoJ3Jlc05hdicsIFtmdW5jdGlvbigpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0ICAgIDogJ0UnLFxuICAgIHNjb3BlICAgICAgIDoge30sXG4gICAgdHJhbnNjbHVkZSAgOiB0cnVlLFxuICAgIHRlbXBsYXRlVXJsIDogJy90ZW1wbGF0ZXMvZGlyZWN0aXZlcy9yZXMtbmF2Lmh0bWwnLFxuICAgIGNvbnRyb2xsZXIgIDogJ1Jlc0NvbnRyb2xsZXInXG4gIH07XG59XSk7XG5cbiIsIkJvb2tpbmcuZGlyZWN0aXZlKCd0b3BOYXYnLCBbZnVuY3Rpb24oKXtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdCAgICA6ICdFJyxcbiAgICBzY29wZSAgICAgICA6IHt9LFxuICAgIHRyYW5zY2x1ZGUgIDogdHJ1ZSxcbiAgICB0ZW1wbGF0ZVVybCA6ICcvdGVtcGxhdGVzL2RpcmVjdGl2ZXMvaGVhZGVyLmh0bWwnLFxuICAgIGNvbnRyb2xsZXIgIDogJ0hlYWRlckNvbnRyb2xsZXInXG4gIH07XG59XSk7XG5cbiIsIkJvb2tpbmcuZGlyZWN0aXZlKCd1c2VyX3Byb2ZpbGUnLCBbZnVuY3Rpb24oKXtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdCAgICA6ICdFJyxcbiAgICB0ZW1wbGF0ZVVybCA6ICcvdGVtcGxhdGVzL3VzZXJfcHJvZmlsZS5odG1sJ1xuICB9O1xufV0pO1xuIiwiQm9va2luZy5jb250cm9sbGVyKCdjb25maXJtYXRpb25Db250cm9sbGVyJywgWydEYXRhU2VydmljZScsJyRzdGF0ZScsJyRzY29wZScsJ1Jlc2VydmF0aW9uU2VydmljZScsIGZ1bmN0aW9uKERhdGFTZXJ2aWNlLCRzdGF0ZSwkc2NvcGUsUmVzZXJ2YXRpb25TZXJ2aWNlKXtcclxuICAgJHNjb3BlLmZvcm1EYXRhPURhdGFTZXJ2aWNlLmdldCgpOyAgICAgXHJcbiAgICRzY29wZS5ndWVzdGluZm89IF8uZmluZFdoZXJlKCRzY29wZS5mb3JtRGF0YSwge2lkOlwiZ3Vlc3RpbmZvXCJ9KS5jdXN0b21lclByb2ZpbGU7XHJcbiAgICRzY29wZS5jYXJkaW5mbz1fLmZpbmRXaGVyZSgkc2NvcGUuZm9ybURhdGEsIHtpZDpcInBheW1lbnRpbmZvXCJ9KS5wYXltZW50RGV0YWlscztcclxuICAgJHNjb3BlLmJvb2tpbmdpbmZvPV8uZmluZFdoZXJlKCRzY29wZS5mb3JtRGF0YSwge2lkOlwiYm9va2luZ2luZm9cIn0pLnNlbGVjdGVkcm9vbXM7XHJcbiAgICAkc2NvcGUuZ3Vlc3RTdW1tYXJ5PV8uZmluZFdoZXJlKCRzY29wZS5mb3JtRGF0YSwge2lkOlwiYm9va2luZ2luZm9cIn0pLnF1ZXJyeTtcclxuICAgICRzY29wZS5yb29tc1N1bW1hcnk9Xy5maW5kV2hlcmUoJHNjb3BlLmZvcm1EYXRhLCB7aWQ6XCJyb29taW5mb1wifSkuc3VtbWFyeTtcclxuICAgJHNjb3BlLmNvbXBhbnlfaWQ9Xy5maW5kV2hlcmUoJHNjb3BlLmZvcm1EYXRhLCB7aWQ6XCJib29raW5naW5mb1wifSkuY29tcGFueWlkO1xyXG5cclxuICAgXHJcblxyXG4gICAkc2NvcGUucHJvY2Vzc0Zvcm09ZnVuY3Rpb24oKXtcclxuICAgIHZhciBkYXRhID17fTtcclxuICAgICAgICBkYXRhLmd1ZXN0aW5mbz0kc2NvcGUuZ3Vlc3RpbmZvO1xyXG4gICAgICAgIGRhdGEuY2FyZGluZm89JHNjb3BlLmNhcmRpbmZvO1xyXG4gICAgICAgIGRhdGEuYm9va2luZ2luZm89JHNjb3BlLmJvb2tpbmdpbmZvO1xyXG4gICAgICAgICBkYXRhLmd1ZXN0U3VtbWFyeT0kc2NvcGUuZ3Vlc3RTdW1tYXJ5O1xyXG4gICAgICAgICBkYXRhLnJvb21TdW1tYXJ5PSRzY29wZS5yb29tc1N1bW1hcnk7XHJcbiAgICAgICAgIGRhdGEuY29tcGFueV9pZD0kc2NvcGUuY29tcGFueV9pZDtcclxuXHJcblxyXG4gICAgIFJlc2VydmF0aW9uU2VydmljZS5jcmVhdGUoZGF0YSlcclxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAocmVzcCkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQocmVzcCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5mb3JtRGF0YT1cIlwiO1xyXG4gICAgICAgICAgICAgICAgLy9jbGVhciBkYXRhIHNlcnZpY2UgZGF0YVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAocmVzcCkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJyb3IgXCIrcmVzcCk7XHJcbiAgICAgICAgICAgIH0pOyAgXHJcblxyXG4gICB9O1xyXG4gICBcclxuXHJcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ0Zvb3RlckNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7XG59XSk7XG5cbiIsIkJvb2tpbmcuY29udHJvbGxlcignZ3Vlc3RDb250cm9sbGVyJywgWydEYXRhU2VydmljZScsJyRzdGF0ZScsJyRzY29wZScsIGZ1bmN0aW9uKERhdGFTZXJ2aWNlLCRzdGF0ZSwkc2NvcGUpe1xyXG4gICAkc2NvcGUuZm9ybURhdGE9e307XHJcblxyXG5cclxuICAgJHNjb3BlLnBheW1lbnQ9ZnVuY3Rpb24oKXtcclxuXHJcblx0ICAgXHQgdmFyIGRhdGE9e307XHJcblx0ICAgXHQgZGF0YS5pZD0nZ3Vlc3RpbmZvJztcclxuXHQgICBcdCBkYXRhLmN1c3RvbWVyUHJvZmlsZT0kc2NvcGUuZm9ybURhdGE7XHJcblx0ICAgXHREYXRhU2VydmljZS5zYXZlKGRhdGEpO1xyXG5cdCAgIFx0JHN0YXRlLmdvKCdwYXltZW50Jyk7XHJcbiAgIH07XHJcblxyXG59XSk7IiwiQm9va2luZy5jb250cm9sbGVyKCdIZWFkZXJDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xufV0pO1xuXG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ0xvZ291dENvbnRyb2xsZXInLCBbJyRsb2NhdGlvbicsICdMb2dpblNlcnZpY2UnLCBmdW5jdGlvbigkbG9jYXRpb24sIExvZ2luU2VydmljZSl7XG4gIExvZ2luU2VydmljZS5sb2dvdXQoKTtcbiAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xufV0pO1xuXG5cbiIsIkJvb2tpbmcuY29udHJvbGxlcigncGF5bWVudENvbnRyb2xsZXInLCBbJ0RhdGFTZXJ2aWNlJywnJHN0YXRlJywnJHNjb3BlJywgZnVuY3Rpb24oRGF0YVNlcnZpY2UsJHN0YXRlLCRzY29wZSl7XHJcbiAgICRzY29wZS5mb3JtRGF0YT17fTtcclxuXHJcblxyXG4gICAkc2NvcGUuZ290b0NvbmZpcm09ZnVuY3Rpb24oKXtcclxuXHQgICBcdCB2YXIgZGF0YT17fTtcclxuXHQgICBcdCBkYXRhLmlkPSdwYXltZW50aW5mbyc7XHJcblx0ICAgXHQgZGF0YS5wYXltZW50RGV0YWlscz0kc2NvcGUuZm9ybURhdGE7XHJcblx0ICAgXHREYXRhU2VydmljZS5zYXZlKGRhdGEpO1xyXG5cdCAgIFx0JHN0YXRlLmdvKCdDb25maXJtYXRpb24nKTtcclxuICAgfTtcclxuXHJcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ1Jlc0NvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7XG59XSk7XG5cbiIsIkJvb2tpbmcuY29udHJvbGxlcignUmVzZXJ2ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsJyRzdGF0ZVBhcmFtcycsJyRzdGF0ZScsJ1Jlc2VydmF0aW9uU2VydmljZScsICdEYXRhU2VydmljZScsJyRhbmNob3JTY3JvbGwnLCckbG9jYXRpb24nLGZ1bmN0aW9uKCRzY29wZSwkc3RhdGVQYXJhbXMsJHN0YXRlLFJlc2VydmF0aW9uU2VydmljZSxEYXRhU2VydmljZSwkYW5jaG9yU2Nyb2xsLCRsb2NhdGlvbil7XHJcbiAgICRsb2NhdGlvbi5oYXNoKCd0b3AnKTtcclxuXHJcbiAgICAgIC8vIGNhbGwgJGFuY2hvclNjcm9sbCgpXHJcbiAgICAgICRhbmNob3JTY3JvbGwoKTtcclxuXHJcblx0XHJcbiAgJHNjb3BlLmZvcm1EYXRhID0ge307XHJcbiAkc2NvcGUuZm9ybURhdGEucm9vbURldGFpbHM9YW5ndWxhci5mcm9tSnNvbihhdG9iKCRzdGF0ZVBhcmFtcy5yb29tZGV0YWlscykpO1xyXG4gIGNvbnNvbGUubG9nKCRzY29wZS5mb3JtRGF0YS5yb29tRGV0YWlscyk7XHJcblxyXG4gICRzY29wZS5zdW1tYXJ5PXt9O1xyXG4gICRzY29wZS5zdW1tYXJ5Lm5vUm9vbXM9JHNjb3BlLmZvcm1EYXRhLnJvb21EZXRhaWxzLnNlbGVjdGVkcm9vbXMubGVuZ3RoO1xyXG4gICRzY29wZS5zdW1tYXJ5Lm5vR3Vlc3Q9ICRzY29wZS5mb3JtRGF0YS5yb29tRGV0YWlscy5xdWVycnkuYWR1bHRzOyBcclxuICAkc2NvcGUuc3VtbWFyeS5zdGFydGRhdGU9JHNjb3BlLmZvcm1EYXRhLnJvb21EZXRhaWxzLnF1ZXJyeS5jaGVja19pbjtcclxuICAkc2NvcGUuc3VtbWFyeS5lbmRkYXRlPSRzY29wZS5mb3JtRGF0YS5yb29tRGV0YWlscy5xdWVycnkuY2hlY2tfb3V0O1xyXG5cclxuICAkc2NvcGUudG90YWxwcmljZT1mdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciB0cHJpY2U9MDtcclxuICAgICAgICBcclxuXHJcbiAgICAgICBmb3IgKHZhciBpPTAgIDtpPCRzY29wZS5zdW1tYXJ5Lm5vUm9vbXM7aSsrKXtcclxuXHJcbiAgICAgICAgICAgdHByaWNlPXRwcmljZSskc2NvcGUuZm9ybURhdGEucm9vbURldGFpbHMuc2VsZWN0ZWRyb29tc1tpXS5yb29tLmJhc2VfcHJpY2U7XHJcbiAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRwcmljZTtcclxuICAgICAgfTtcclxuXHJcblxyXG5cclxuJHNjb3BlLnN1bW1hcnkudFByaWNlPSAkc2NvcGUudG90YWxwcmljZSgpOyBcclxuXHJcbiAgICBcclxuICAgIC8vIGZ1bmN0aW9uIHRvIHByb2Nlc3MgdGhlIGZvcm1cclxuICAgICRzY29wZS5wcm9jZXNzRm9ybSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgLy8gYWxlcnQoJ2F3ZXNvbWUhJyk7XHJcblxyXG4gICAgICAgICAgUmVzZXJ2YXRpb25TZXJ2aWNlLmNyZWF0ZSgkc2NvcGUuZm9ybURhdGEpXHJcbiAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiZGF0YSBzYXZlZCBSZXNlcnZhdGlvbiBJRCA5ODg5XCIpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZvcm1EYXRhPVwiXCI7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJyb3IgXCIrZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pOyAgXHJcblxyXG5cclxuICAgIH07XHJcblxyXG5cclxuICAgICRzY29wZS5wcm9jZWVkPWZ1bmN0aW9uKCl7XHJcbiAgICAgIHZhciBkYXRhPXt9O1xyXG4gICAgICAgIGRhdGEuaWQ9J3Jvb21pbmZvJztcclxuICAgICAgICBkYXRhLnJvb21kZXRhaWxzPSRzY29wZS5mb3JtRGF0YTtcclxuICAgICAgICBkYXRhLnN1bW1hcnk9JHNjb3BlLnN1bW1hcnk7XHJcbiAgICAgICAgIERhdGFTZXJ2aWNlLnNhdmUoZGF0YSk7XHJcbiAgICAgICAgICAgJHN0YXRlLmdvKCdndWVzdGluZm8nKTtcclxuICAgIH07XHJcblxyXG4gICAgXHJcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ1Jlc2VydmVQYXltZW50Q29udHJvbGxlcicsIFsnUmVzZXJ2YXRpb25TZXJ2aWNlJywgZnVuY3Rpb24oUmVzZXJ2YXRpb25TZXJ2aWNlKXtcclxuXHJcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ2Jvb2tpbmdDb250cm9sbGVyJywgWydSZXNlcnZhdGlvblNlcnZpY2UnLCBmdW5jdGlvbihSZXNlcnZhdGlvblNlcnZpY2Upe1xyXG5cclxufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==