var Booking;Booking=angular.module("Booking",["ngRoute","ngCookies"]),Booking.config(["$routeProvider","$locationProvider",function(o,e){o.when("/",{templateUrl:"/templates/admin/index.html",controller:"HomeController"}).when("/login",{templateUrl:"/templates/admin/login.html",controller:"LoginController"}).when("/logout",{templateUrl:"templates/admin/logout.html",controller:"LogoutController"}).otherwise({redirectTo:"/"})}]),Booking.run(["$rootScope","$location","LoginService",function(o,e,l){o.$on("$routeChangeStart",function(n,t,r){null===l.user()&&(o.loggedIn=null,"/templates/admin/login.html"===t.templateUrl||e.path("/login"))})}]);
Booking.factory("CompanyService",["$http",function(n){return{data:function(t){n.get("/api/company").success(function(n,c){t(n)})}}}]);
Booking.factory("CustomerService",["$http",function(t){return{data:function(c){t.get("/api/customer").success(function(t,n){c(t)})}}}]);
Booking.service("DataService",["$http",function(o){var t=[];this.save=function(o){t.push(o),console.log("data Saved"),console.log(t)},this.get=function(){return t}}]);
Booking.factory("InventoryService",["$http",function(t){var n=10001;return{results:[],data:function(n){t.get("/api/inventory").success(function(t,i){n(t)})},query:function(i,s){t.post("/api/availability/"+n,i).success(function(t,n){this.results=t,s(t)}.bind(this))}}}]);
Booking.factory("LoginService",["$http","$cookies","$rootScope",function(o,n,e){return{auth:function(e,r){o.post("/api/login",e).success(function(o,e){n.put("user",JSON.stringify(o)),r(o,e)}).error(function(){console.log("error")})},user:function(){var o=null;return n.get("user")&&(e.loggedIn=o=JSON.parse(n.get("user"))),o},logout:function(){e.loggedIn=null,n.remove("user")}}}]);
Booking.factory("PoliciesService",["$http",function(i){return{data:function(c){i.get("/api/policies").success(function(i,t){c(i)})}}}]);
Booking.factory("ReservationService",["$http",function(r){var t={};return t.data=function(){return r.get("/api/reservation")},t.query=function(t){return r.get("/api/reservation")},t.create=function(t){return r.post("/api/reservation",t)},t}]);
Booking.factory("RoleService",["$http",function(t){return{data:function(n){t.get("/api/role").success(function(t,o){n(t)})}}}]);
Booking.factory("UsersService",["$http",function(t){return{data:function(n){t.get("/api/users").success(function(t,c){n(t)})}}}]);
Booking.directive("availability",["$rootScope","dateFilter",function(e,o){return{restrict:"E",templateUrl:"/templates/directives/availability.html",controller:["$scope","$location","ReservationService","$stateParams","DataService",function(e,o,r,t,s){e.selectedrooms=[],e.number=-1,e.querry=angular.fromJson(atob(t.querry)),console.log("test"),console.log(e.querry),e.selectroom=function(o,r){var t={};t.id=o,t.room=r,r.selected=!0,e.selectedrooms.push(t),e.number=o,console.log(e.selectedrooms)},e.removeroom=function(o){for(i in e.selectedrooms)e.selectedrooms[i].id==o&&e.selectedrooms.splice(i,1)},e.book=function(){var r={};r.selectedrooms=e.selectedrooms,r.querry=e.querry;var t=btoa(angular.toJson(r));s.save(r),o.path("/reserve/"+t)},e.submit=function(){r.query(e.query).success(function(e){}).error(function(e){alert("Errror "+e.message)})}}]}}]);
Booking.directive("footerNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/footer.html",controller:"FooterController"}}]);
Booking.directive("home",[function(){return{restrict:"E",templateUrl:"/templates/home.html"}}]);
Booking.directive("inventory",[function(){return{restrict:"E",templateUrl:"/templates/inventory.html"}}]);
Booking.directive("leftNav",[function(){return{restrict:"A",scope:{},transclude:!0,templateUrl:"/templates/directives/left_nav.html",controller:"LeftNavController"}}]);
Booking.directive("login",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/login.html",controller:"LoginController"}}]);
Booking.directive("policies",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/policies.html",controller:"PoliciesController"}}]);
Booking.directive("query",["$rootScope","dateFilter","$location",function(t,e,o){return{restrict:"E",templateUrl:"/templates/directives/query.html",controller:["$scope","InventoryService",function(e,r){e.max_adults=[1,2,3],e.max_childs=[0,1,2,3],e.query={adults:1,childs:0,check_in:(new moment).toDate(),check_out:(new moment).add(3,"days").toDate()},e.submit=function(){r.query(e.query,function(e){t.$broadcast("query:results")});var n=btoa(angular.toJson(e.query));o.path("/booking/"+n)}}]}}]);
Booking.directive("resNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/res-nav.html",controller:"ResController"}}]);
Booking.directive("topNav",[function(){return{restrict:"E",scope:{},transclude:!0,templateUrl:"/templates/directives/header.html",controller:"HeaderController"}}]);
Booking.directive("users",[function(){return{restrict:"E",templateUrl:"/templates/users.html"}}]);
Booking.directive("user_profile",[function(){return{restrict:"E",templateUrl:"/templates/user_profile.html"}}]);
Booking.controller("CustomerController",["CustomerService",function(o){this.customer=null,this.data="Booking Customer";var t=this;CustomerService.data(function(o){t.customer=o,console.log(o)})}]);
Booking.controller("FooterController",["$scope",function(o){}]);
Booking.controller("guestController",["DataService","$state","$scope",function(o,t,e){e.formData={},e.payment=function(){var a={};a.id="guestinfo",a.customerProfile=e.formData,o.save(a),t.go("payment")}}]);
Booking.controller("HeaderController",["$scope",function(o){}]);
Booking.controller("HomeController",["CompanyService",function(o){this.company=null,this.data="Booking Home";var n=this;o.data(function(o){n.company=o,console.log(o)})}]);
Booking.controller("InventoryController",["$rootScope","InventoryService",function(t,o){this.results=o.results,t.$on("query:results",function(){this.results=o.results}.bind(this))}]);
Booking.controller("LeftNavController",["$scope",function(o){}]);
Booking.controller("LoginController",["$rootScope","$scope","$location","LoginService",function(o,n,t,i){n.submit=function(){i.auth(n.user,function(n,i){200===i&&(o.loggedIn=n,t.path("/"))})}}]);
Booking.controller("LogoutController",["$location","LoginService",function(o,n){n.logout(),o.path("/login")}]);
Booking.controller("paymentController",["DataService","$state","$scope",function(o,t,a){a.formData={},a.gotoConfirm=function(){var n={};n.id="paymentinfo",n.paymentDetails=a.formData,o.save(n),t.go("Confirmation")}}]);
Booking.controller("PoliciesController",["$rootScope","$scope","$location",function(o,i,c){i.policies=function(o){return policies.show=!0}}]);
Booking.controller("ResController",["$scope",function(o){}]);
Booking.controller("ReservationController",["ReservationService",function(o){this.reservation=null,this.data="Booking Rerservation";var e=this;RoleService.data(function(o){e.reservation=o,console.log(o)})}]);
Booking.controller("ReserveController",["$scope","$stateParams","$state","ReservationService","DataService",function(o,r,a,e,t){o.formData={},o.formData.roomDetails=angular.fromJson(atob(r.roomdetails)),console.log(o.formData.roomDetails),o.summary={},o.summary.noRooms=o.formData.roomDetails.selectedrooms.length,o.summary.noGuest=o.formData.roomDetails.querry.adults,o.summary.startdate=o.formData.roomDetails.querry.check_in,o.summary.enddate=o.formData.roomDetails.querry.check_out,o.totalprice=function(){for(var r=0,a=0;a<o.summary.noRooms;a++)r+=o.formData.roomDetails.selectedrooms[a].room.base_price;return r},o.summary.tPrice=o.totalprice(),o.processForm=function(){e.create(o.formData).success(function(r){alert("data saved Reservation ID 9889"),o.formData=""}).error(function(o){alert("Errror "+o.message)})},o.proceed=function(){var r={};r.roomdetails=o.formData,r.summary=o.summary,t.save(r),a.go("guestinfo")}}]);
Booking.controller("ReservePaymentController",["ReservationService",function(e){}]);
Booking.controller("bookingController",["ReservationService",function(o){}]);
Booking.controller("RoleController",["RoleService",function(o){this.role=null,this.data="Booking User Role";var l=this;o.data(function(o){l.role=o,console.log(o)})}]);
Booking.controller("UsersController",["UsersService",function(s){this.users=null,this.data="Booking Users";var o=this;s.data(function(s){o.users=s,console.log(s)})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmpzIiwiY29tcGFueS5qcyIsImN1c3RvbWVyLmpzIiwiRGF0YVNlcnZpY2UuanMiLCJpbnZlbnRvcnkuanMiLCJsb2dpbi5qcyIsInBvbGljaWVzLmpzIiwicmVzZXJ2YXRpb24uanMiLCJyb2xlLmpzIiwidXNlcnMuanMiLCJhdmFpbGFiaWxpdHkuanMiLCJmb290ZXJfbmF2LmpzIiwiaG9tZS5qcyIsImxlZnRfbmF2LmpzIiwicXVlcnkuanMiLCJyZXpfbmF2LmpzIiwidG9wX25hdi5qcyIsInVzZXJfcHJvZmlsZS5qcyIsImZvb3Rlci5qcyIsImd1ZXN0Q29udHJvbGxlci5qcyIsImhlYWRlci5qcyIsImxvZ291dC5qcyIsInBheW1lbnRDb250cm9sbGVyLmpzIiwicmVzLWhlYWRlci5qcyIsIlJlc2VydmVDb250cm9sbGVyLmpzIiwiUmVzZXJ2ZVBheW1lbnRDb250cm9sbGVyLmpzIiwiUmVzZXJ2ZVByb2ZpbGVDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIkJvb2tpbmciLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwicnVuIiwiJHJvb3RTY29wZSIsIiRsb2NhdGlvbiIsIkxvZ2luU2VydmljZSIsIiRvbiIsImV2ZW50IiwibmV4dCIsImN1cnJlbnQiLCJ1c2VyIiwibG9nZ2VkSW4iLCJwYXRoIiwiZmFjdG9yeSIsIiRodHRwIiwiZGF0YSIsImNhbGxiYWNrIiwiZ2V0Iiwic3VjY2VzcyIsInN0YXR1cyIsInNlcnZpY2UiLCJ0aGlzIiwic2F2ZSIsImR0IiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJjb21wYW55X2lkIiwicmVzdWx0cyIsInF1ZXJ5IiwicG9zdCIsImJpbmQiLCIkY29va2llcyIsImF1dGgiLCJjcmVkZW50aWFscyIsInB1dCIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcnJvciIsInBhcnNlIiwibG9nb3V0IiwicmVtb3ZlIiwicmVzZXJ2YXRpb24iLCJxdWVycnkiLCJjcmVhdGUiLCJkaXJlY3RpdmUiLCJkYXRlRmlsdGVyIiwicmVzdHJpY3QiLCIkc2NvcGUiLCJSZXNlcnZhdGlvblNlcnZpY2UiLCIkc3RhdGVQYXJhbXMiLCJEYXRhU2VydmljZSIsInNlbGVjdGVkcm9vbXMiLCJudW1iZXIiLCJmcm9tSnNvbiIsImF0b2IiLCJzZWxlY3Ryb29tIiwiaW5kZXgiLCJyb29tIiwicm0iLCJpZCIsInNlbGVjdGVkIiwicmVtb3Zlcm9vbSIsImkiLCJzcGxpY2UiLCJib29rIiwiayIsImRldCIsImJ0b2EiLCJ0b0pzb24iLCJzdWJtaXQiLCJhbGVydCIsIm1lc3NhZ2UiLCJzY29wZSIsInRyYW5zY2x1ZGUiLCJJbnZlbnRvcnlTZXJ2aWNlIiwibWF4X2FkdWx0cyIsIm1heF9jaGlsZHMiLCJhZHVsdHMiLCJjaGlsZHMiLCJjaGVja19pbiIsIm1vbWVudCIsInRvRGF0ZSIsImNoZWNrX291dCIsImFkZCIsIiRicm9hZGNhc3QiLCJVc2Vyc1NlcnZpY2UiLCJjdXN0b21lciIsIl9zZWxmIiwiQ3VzdG9tZXJTZXJ2aWNlIiwiJHN0YXRlIiwiZm9ybURhdGEiLCJwYXltZW50IiwiY3VzdG9tZXJQcm9maWxlIiwiZ28iLCJDb21wYW55U2VydmljZSIsImNvbXBhbnkiLCJnb3RvQ29uZmlybSIsInBheW1lbnREZXRhaWxzIiwicG9saWNpZXMiLCJzaG93IiwiUm9sZVNlcnZpY2UiLCJyb29tRGV0YWlscyIsInJvb21kZXRhaWxzIiwic3VtbWFyeSIsIm5vUm9vbXMiLCJsZW5ndGgiLCJub0d1ZXN0Iiwic3RhcnRkYXRlIiwiZW5kZGF0ZSIsInRvdGFscHJpY2UiLCJ0cHJpY2UiLCJiYXNlX3ByaWNlIiwidFByaWNlIiwicHJvY2Vzc0Zvcm0iLCJwcm9jZWVkIiwicm9sZSIsInVzZXJzIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxRQUVKQSxTQUFVQyxRQUFR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QU8yQyxTQUN4QjVFLEVBQUt5RixRQUFReEQsRUFBT3dELFFBQ25CckQsRUFBWTdCLEtBQUtQLEdBQ2YyRSxFQUFPSSxHQUFHO0FDckRyQnZHLFFBQVFRLFdBQVcsNEJBQTZCLHFCQUFzQixTQUFTa0Q7QUNBL0UxRCxRQUFRUSxXQUFXLHFCQUFzQixxQkFBc0IsU0FBU2tEO0FsQkF4RTFELFFBQVFRLFdBQVcsa0JBQW1CLGNBQWUsU0FBU3NHLEdBQzVEaEYsS0FBSytGLEtBQU8sS0FDWi9GLEtBQUtOLEtBQU8sbUJBQ1osSUFBSXlFLEdBQVFuRSxJQUVaZ0YsR0FBWXRGLEtBQUssU0FBU0EsR0FDeEJ5RSxFQUFNNEIsS0FBT3JHLEVBQ2JVLFFBQVFDLElBQUlYO0FDUGhCeEIsUUFBUVEsV0FBVyxtQkFBb0IsZUFBZ0IsU0FBU3VGLEdBQzlEakUsS0FBS2dHLE1BQVEsS0FDYmhHLEtBQUtOLEtBQU8sZUFDWixJQUFJeUUsR0FBUW5FLElBRVppRSxHQUFhdkUsS0FBSyxTQUFTQSxHQUN6QnlFLEVBQU02QixNQUFRdEcsRUFDZFUsUUFBUUMsSUFBSVgiLCJmaWxlIjoiYWRtaW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgQm9va2luZztcblxuQm9va2luZyA9IGFuZ3VsYXIubW9kdWxlKCdCb29raW5nJywgWyduZ1JvdXRlJywgJ25nQ29va2llcyddKTtcblxuQm9va2luZy5jb25maWcoWyckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcil7XG4gICRyb3V0ZVByb3ZpZGVyXG4gICAgLndoZW4oJy8nLCB7XG4gICAgICB0ZW1wbGF0ZVVybCA6ICcvdGVtcGxhdGVzL2FkbWluL2luZGV4Lmh0bWwnLFxuICAgICAgY29udHJvbGxlciAgOiAnSG9tZUNvbnRyb2xsZXInXG4gICAgfSlcbiAgICAud2hlbignL2xvZ2luJywge1xuICAgICAgdGVtcGxhdGVVcmwgOiAnL3RlbXBsYXRlcy9hZG1pbi9sb2dpbi5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXIgIDogJ0xvZ2luQ29udHJvbGxlcidcbiAgICB9KVxuICAgIC53aGVuKCcvbG9nb3V0Jywge1xuICAgICAgdGVtcGxhdGVVcmwgOiAndGVtcGxhdGVzL2FkbWluL2xvZ291dC5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXIgIDogJ0xvZ291dENvbnRyb2xsZXInXG4gICAgfSlcbiAgICAub3RoZXJ3aXNlKHsgcmVkaXJlY3RUbyA6ICcvJyB9KTtcblxuICAvLyRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbn1dKTtcblxuQm9va2luZy5ydW4oWyckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICdMb2dpblNlcnZpY2UnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkbG9jYXRpb24sIExvZ2luU2VydmljZSl7XG4gICRyb290U2NvcGUuJG9uKFwiJHJvdXRlQ2hhbmdlU3RhcnRcIiwgZnVuY3Rpb24oZXZlbnQsIG5leHQsIGN1cnJlbnQpe1xuICAgIGlmIChMb2dpblNlcnZpY2UudXNlcigpID09PSBudWxsKSB7XG4gICAgICAkcm9vdFNjb3BlLmxvZ2dlZEluID0gbnVsbDtcbiAgICAgIGlmICggbmV4dC50ZW1wbGF0ZVVybCA9PT0gJy90ZW1wbGF0ZXMvYWRtaW4vbG9naW4uaHRtbCcpIHtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufV0pO1xuXG4iLCJCb29raW5nLmZhY3RvcnkoJ0NvbXBhbnlTZXJ2aWNlJywgWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKXtcbiAgcmV0dXJuIHtcbiAgICBkYXRhIDogZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgICRodHRwLmdldCgnL2FwaS9jb21wYW55JylcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcbiAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG59XSk7XG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ0N1c3RvbWVyQ29udHJvbGxlcicsIFsnQ3VzdG9tZXJTZXJ2aWNlJywgZnVuY3Rpb24oVXNlcnNTZXJ2aWNlKXtcbiAgdGhpcy5jdXN0b21lciA9IG51bGw7XG4gIHRoaXMuZGF0YSA9ICdCb29raW5nIEN1c3RvbWVyJztcbiAgdmFyIF9zZWxmID0gdGhpcztcblxuICBDdXN0b21lclNlcnZpY2UuZGF0YShmdW5jdGlvbihkYXRhKXtcbiAgICBfc2VsZi5jdXN0b21lciA9IGRhdGE7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG4gIH0pO1xufV0pOyIsIkJvb2tpbmcuc2VydmljZSgnRGF0YVNlcnZpY2UnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApe1xyXG5cclxuXHQgIHZhciBkYXRhPVtdXHJcblxyXG5cclxuXHQgICB0aGlzLnNhdmU9ZnVuY3Rpb24oZHQpe1xyXG5cdCAgICAgXHRkYXRhLnB1c2goZHQpO1xyXG5cdCAgICAgXHRjb25zb2xlLmxvZyhcImRhdGEgU2F2ZWRcIik7XHJcblx0ICAgICBcdGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cclxuXHQgICB9XHJcblx0ICAgdGhpcy5nZXQ9ZnVuY3Rpb24oKXtcclxuXHQgICBcdHJldHVybiBkYXRhO1xyXG5cdCAgIH1cclxuXHJcbiAgICAgXHJcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ0ludmVudG9yeUNvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnSW52ZW50b3J5U2VydmljZScsIGZ1bmN0aW9uKCRyb290U2NvcGUsIEludmVudG9yeVNlcnZpY2Upe1xuICB0aGlzLnJlc3VsdHMgPSBJbnZlbnRvcnlTZXJ2aWNlLnJlc3VsdHM7XG5cbiAgJHJvb3RTY29wZS4kb24oJ3F1ZXJ5OnJlc3VsdHMnLCBmdW5jdGlvbigpe1xuICAgIHRoaXMucmVzdWx0cyA9IEludmVudG9yeVNlcnZpY2UucmVzdWx0cztcbiAgfS5iaW5kKHRoaXMpKTtcblxuXG5cbn1dKTtcbiIsIkJvb2tpbmcuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckbG9jYXRpb24nLCAnTG9naW5TZXJ2aWNlJyxcbiAgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkbG9jYXRpb24sIExvZ2luU2VydmljZSl7XG4gICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICBMb2dpblNlcnZpY2UuYXV0aCgkc2NvcGUudXNlciwgZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcbiAgICAgICAgaWYgKHN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgJHJvb3RTY29wZS5sb2dnZWRJbiA9IGRhdGE7XG4gICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICB9XVxuKTtcblxuIiwiQm9va2luZy5jb250cm9sbGVyKCdQb2xpY2llc0NvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uKXtcbiAgICAkc2NvcGUucG9saWNpZXMgPSBmdW5jdGlvbihzaG93KSB7XG4gICAgICByZXR1cm4gcG9saWNpZXMuc2hvdyA9IHRydWU7ICBcbiAgICB9O1xuICB9XG5dKTtcblxuIiwiQm9va2luZy5jb250cm9sbGVyKCdSZXNlcnZhdGlvbkNvbnRyb2xsZXInLCBbJ1Jlc2VydmF0aW9uU2VydmljZScsIGZ1bmN0aW9uKFJlc2VydmF0aW9uU2VydmljZSl7XG4gIHRoaXMucmVzZXJ2YXRpb24gPSBudWxsO1xuICB0aGlzLmRhdGEgPSAnQm9va2luZyBSZXJzZXJ2YXRpb24nO1xuICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gIFJvbGVTZXJ2aWNlLmRhdGEoZnVuY3Rpb24oZGF0YSl7XG4gICAgX3NlbGYucmVzZXJ2YXRpb24gPSBkYXRhO1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICB9KTtcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ1JvbGVDb250cm9sbGVyJywgWydSb2xlU2VydmljZScsIGZ1bmN0aW9uKFJvbGVTZXJ2aWNlKXtcbiAgdGhpcy5yb2xlID0gbnVsbDtcbiAgdGhpcy5kYXRhID0gJ0Jvb2tpbmcgVXNlciBSb2xlJztcbiAgdmFyIF9zZWxmID0gdGhpcztcblxuICBSb2xlU2VydmljZS5kYXRhKGZ1bmN0aW9uKGRhdGEpe1xuICAgIF9zZWxmLnJvbGUgPSBkYXRhO1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICB9KTtcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ1VzZXJzQ29udHJvbGxlcicsIFsnVXNlcnNTZXJ2aWNlJywgZnVuY3Rpb24oVXNlcnNTZXJ2aWNlKXtcbiAgdGhpcy51c2VycyA9IG51bGw7XG4gIHRoaXMuZGF0YSA9ICdCb29raW5nIFVzZXJzJztcbiAgdmFyIF9zZWxmID0gdGhpcztcblxuICBVc2Vyc1NlcnZpY2UuZGF0YShmdW5jdGlvbihkYXRhKXtcbiAgICBfc2VsZi51c2VycyA9IGRhdGE7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG4gIH0pO1xufV0pOyIsIkJvb2tpbmcuZGlyZWN0aXZlKCdhdmFpbGFiaWxpdHknLCBbJyRyb290U2NvcGUnLCAnZGF0ZUZpbHRlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsIGRhdGVGaWx0ZXIpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0ICAgIDogJ0UnLFxuICAgIHRlbXBsYXRlVXJsIDogJy90ZW1wbGF0ZXMvZGlyZWN0aXZlcy9hdmFpbGFiaWxpdHkuaHRtbCcsXG4gICAgY29udHJvbGxlciAgOiBbJyRzY29wZScsJyRsb2NhdGlvbicsJ1Jlc2VydmF0aW9uU2VydmljZScsJyRzdGF0ZVBhcmFtcycsJ0RhdGFTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCRsb2NhdGlvbixSZXNlcnZhdGlvblNlcnZpY2UsJHN0YXRlUGFyYW1zLERhdGFTZXJ2aWNlKXtcbiAgICAgIFxuICAgICAgJHNjb3BlLnNlbGVjdGVkcm9vbXM9W107XG4gICAgICAkc2NvcGUubnVtYmVyPS0xO1xuICAkc2NvcGUucXVlcnJ5PSBhbmd1bGFyLmZyb21Kc29uKGF0b2IoJHN0YXRlUGFyYW1zLnF1ZXJyeSkpXG4gICAgIFxuICAgICAgY29uc29sZS5sb2coXCJ0ZXN0XCIpO1xuICAgICAgY29uc29sZS5sb2coJHNjb3BlLnF1ZXJyeSk7XG5cbiRzY29wZS5zZWxlY3Ryb29tPWZ1bmN0aW9uKGluZGV4LHJvb20pe1xuICAgdmFyIHJtPXt9O1xuICAgIHJtLmlkPWluZGV4O1xuICAgIHJtLnJvb209cm9vbTtcbiAgICByb29tLnNlbGVjdGVkPXRydWU7XG4gICAgJHNjb3BlLnNlbGVjdGVkcm9vbXMucHVzaChybSk7XG4gICAgJHNjb3BlLm51bWJlcj1pbmRleDtcbiAgICBjb25zb2xlLmxvZygkc2NvcGUuc2VsZWN0ZWRyb29tcylcbn07XG4kc2NvcGUucmVtb3Zlcm9vbT1mdW5jdGlvbihpbmRleCl7XG5cbiAgIGZvciAoaSBpbiAkc2NvcGUuc2VsZWN0ZWRyb29tcykge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZHJvb21zW2ldLmlkID09IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkcm9vbXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG59O1xuXG4kc2NvcGUuYm9vaz1mdW5jdGlvbigpe1xuICB2YXIgaz17fTtcbiAgICAgay5zZWxlY3RlZHJvb21zPSRzY29wZS5zZWxlY3RlZHJvb21zO1xuICAgICBrLnF1ZXJyeT0kc2NvcGUucXVlcnJ5O1xuICAgdmFyIGRldD1idG9hKGFuZ3VsYXIudG9Kc29uKGspKTtcbiAgIERhdGFTZXJ2aWNlLnNhdmUoayk7XG4gICRsb2NhdGlvbi5wYXRoKCcvcmVzZXJ2ZS8nK2RldCk7XG4gIFxufTtcblxuICAgICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICBSZXNlcnZhdGlvblNlcnZpY2UucXVlcnkoJHNjb3BlLnF1ZXJ5KVxuICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiRXJycm9yIFwiK2Vycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgfSk7ICBcbiAgICAgICAgXG4gICAgICB9O1xuICAgIH1dXG4gIH07XG59XSk7IiwiQm9va2luZy5kaXJlY3RpdmUoJ2Zvb3Rlck5hdicsIFtmdW5jdGlvbigpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0ICAgIDogJ0UnLFxuICAgIHNjb3BlICAgICAgIDoge30sXG4gICAgdHJhbnNjbHVkZSAgOiB0cnVlLFxuICAgIHRlbXBsYXRlVXJsIDogJy90ZW1wbGF0ZXMvZGlyZWN0aXZlcy9mb290ZXIuaHRtbCcsXG4gICAgY29udHJvbGxlciAgOiAnRm9vdGVyQ29udHJvbGxlcidcbiAgfTtcbn1dKTtcblxuIiwiQm9va2luZy5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIFsnQ29tcGFueVNlcnZpY2UnLCBmdW5jdGlvbihDb21wYW55U2VydmljZSl7XG4gIHRoaXMuY29tcGFueSA9IG51bGw7XG4gIHRoaXMuZGF0YSA9ICdCb29raW5nIEhvbWUnO1xuICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gIENvbXBhbnlTZXJ2aWNlLmRhdGEoZnVuY3Rpb24oZGF0YSl7XG4gICAgX3NlbGYuY29tcGFueSA9IGRhdGE7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG4gIH0pO1xuXG5cblxufV0pO1xuIiwiQm9va2luZy5jb250cm9sbGVyKCdMZWZ0TmF2Q29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKXtcbn1dKTtcblxuIiwiQm9va2luZy5kaXJlY3RpdmUoJ3F1ZXJ5JywgWyckcm9vdFNjb3BlJywgJ2RhdGVGaWx0ZXInLCckbG9jYXRpb24nICxmdW5jdGlvbigkcm9vdFNjb3BlLCBkYXRlRmlsdGVyLCRsb2NhdGlvbil7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3QgICAgOiAnRScsXG4gICAgdGVtcGxhdGVVcmwgOiAnL3RlbXBsYXRlcy9kaXJlY3RpdmVzL3F1ZXJ5Lmh0bWwnLFxuICAgIGNvbnRyb2xsZXIgIDogWyckc2NvcGUnLCAnSW52ZW50b3J5U2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgSW52ZW50b3J5U2VydmljZSl7XG4gICAgICAkc2NvcGUubWF4X2FkdWx0cyA9IFsxLDIsM107XG4gICAgICAkc2NvcGUubWF4X2NoaWxkcyA9IFswLDEsMiwzXTtcbiAgICAgICRzY29wZS5xdWVyeSA9IHtcbiAgICAgICAgYWR1bHRzOiAxLFxuICAgICAgICBjaGlsZHM6IDAsXG4gICAgICAgIGNoZWNrX2luOiBuZXcgbW9tZW50KCkudG9EYXRlKCksXG4gICAgICAgIGNoZWNrX291dDogbmV3IG1vbWVudCgpLmFkZCgzLCAnZGF5cycpLnRvRGF0ZSgpXG4gICAgICB9O1xuXG4gICAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgSW52ZW50b3J5U2VydmljZS5xdWVyeSgkc2NvcGUucXVlcnksIGZ1bmN0aW9uKHJlc3VsdHMpe1xuICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgncXVlcnk6cmVzdWx0cycpO1xuICAgICAgICB9KTtcbiAgICAgICAgICAgICB2YXIgZGV0PWJ0b2EoYW5ndWxhci50b0pzb24oJHNjb3BlLnF1ZXJ5KSk7XG4gICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9ib29raW5nLycrZGV0KTtcbiAgICAgIH1cbiAgICB9XVxuICB9O1xufV0pO1xuXG4iLCJCb29raW5nLmRpcmVjdGl2ZSgncmVzTmF2JywgW2Z1bmN0aW9uKCl7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3QgICAgOiAnRScsXG4gICAgc2NvcGUgICAgICAgOiB7fSxcbiAgICB0cmFuc2NsdWRlICA6IHRydWUsXG4gICAgdGVtcGxhdGVVcmwgOiAnL3RlbXBsYXRlcy9kaXJlY3RpdmVzL3Jlcy1uYXYuaHRtbCcsXG4gICAgY29udHJvbGxlciAgOiAnUmVzQ29udHJvbGxlcidcbiAgfTtcbn1dKTtcblxuIiwiQm9va2luZy5kaXJlY3RpdmUoJ3RvcE5hdicsIFtmdW5jdGlvbigpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0ICAgIDogJ0UnLFxuICAgIHNjb3BlICAgICAgIDoge30sXG4gICAgdHJhbnNjbHVkZSAgOiB0cnVlLFxuICAgIHRlbXBsYXRlVXJsIDogJy90ZW1wbGF0ZXMvZGlyZWN0aXZlcy9oZWFkZXIuaHRtbCcsXG4gICAgY29udHJvbGxlciAgOiAnSGVhZGVyQ29udHJvbGxlcidcbiAgfTtcbn1dKTtcblxuIiwiQm9va2luZy5kaXJlY3RpdmUoJ3VzZXJfcHJvZmlsZScsIFtmdW5jdGlvbigpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0ICAgIDogJ0UnLFxuICAgIHRlbXBsYXRlVXJsIDogJy90ZW1wbGF0ZXMvdXNlcl9wcm9maWxlLmh0bWwnXG4gIH07XG59XSk7XG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ0Zvb3RlckNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7XG59XSk7XG5cbiIsIkJvb2tpbmcuY29udHJvbGxlcignZ3Vlc3RDb250cm9sbGVyJywgWydEYXRhU2VydmljZScsJyRzdGF0ZScsJyRzY29wZScsIGZ1bmN0aW9uKERhdGFTZXJ2aWNlLCRzdGF0ZSwkc2NvcGUpe1xyXG4gICAkc2NvcGUuZm9ybURhdGE9e307XHJcblxyXG5cclxuICAgJHNjb3BlLnBheW1lbnQ9ZnVuY3Rpb24oKXtcclxuXHJcblx0ICAgXHQgdmFyIGRhdGE9e307XHJcblx0ICAgXHQgZGF0YS5pZD0nZ3Vlc3RpbmZvJztcclxuXHQgICBcdCBkYXRhLmN1c3RvbWVyUHJvZmlsZT0kc2NvcGUuZm9ybURhdGE7XHJcblx0ICAgXHREYXRhU2VydmljZS5zYXZlKGRhdGEpO1xyXG5cdCAgIFx0JHN0YXRlLmdvKCdwYXltZW50Jyk7XHJcbiAgIH07XHJcblxyXG59XSk7IiwiQm9va2luZy5jb250cm9sbGVyKCdIZWFkZXJDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xufV0pO1xuXG4iLCJCb29raW5nLmNvbnRyb2xsZXIoJ0xvZ291dENvbnRyb2xsZXInLCBbJyRsb2NhdGlvbicsICdMb2dpblNlcnZpY2UnLCBmdW5jdGlvbigkbG9jYXRpb24sIExvZ2luU2VydmljZSl7XG4gIExvZ2luU2VydmljZS5sb2dvdXQoKTtcbiAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xufV0pO1xuXG5cbiIsIkJvb2tpbmcuY29udHJvbGxlcigncGF5bWVudENvbnRyb2xsZXInLCBbJ0RhdGFTZXJ2aWNlJywnJHN0YXRlJywnJHNjb3BlJywgZnVuY3Rpb24oRGF0YVNlcnZpY2UsJHN0YXRlLCRzY29wZSl7XHJcbiAgICRzY29wZS5mb3JtRGF0YT17fTtcclxuXHJcblxyXG4gICAkc2NvcGUuZ290b0NvbmZpcm09ZnVuY3Rpb24oKXtcclxuXHQgICBcdCB2YXIgZGF0YT17fTtcclxuXHQgICBcdCBkYXRhLmlkPSdwYXltZW50aW5mbyc7XHJcblx0ICAgXHQgZGF0YS5wYXltZW50RGV0YWlscz0kc2NvcGUuZm9ybURhdGE7XHJcblx0ICAgXHREYXRhU2VydmljZS5zYXZlKGRhdGEpO1xyXG5cdCAgIFx0JHN0YXRlLmdvKCdDb25maXJtYXRpb24nKTtcclxuICAgfTtcclxuXHJcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ1Jlc0NvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7XG59XSk7XG5cbiIsIkJvb2tpbmcuY29udHJvbGxlcignUmVzZXJ2ZUNvbnRyb2xsZXInLCBbJyRzY29wZScsJyRzdGF0ZVBhcmFtcycsJyRzdGF0ZScsJ1Jlc2VydmF0aW9uU2VydmljZScsICdEYXRhU2VydmljZScsZnVuY3Rpb24oJHNjb3BlLCRzdGF0ZVBhcmFtcywkc3RhdGUsUmVzZXJ2YXRpb25TZXJ2aWNlLERhdGFTZXJ2aWNlKXtcclxuXHJcblxyXG5cdFxyXG4gICRzY29wZS5mb3JtRGF0YSA9IHt9O1xyXG4gJHNjb3BlLmZvcm1EYXRhLnJvb21EZXRhaWxzPWFuZ3VsYXIuZnJvbUpzb24oYXRvYigkc3RhdGVQYXJhbXMucm9vbWRldGFpbHMpKTtcclxuICBjb25zb2xlLmxvZygkc2NvcGUuZm9ybURhdGEucm9vbURldGFpbHMpO1xyXG5cclxuICAkc2NvcGUuc3VtbWFyeT17fTtcclxuICAkc2NvcGUuc3VtbWFyeS5ub1Jvb21zPSRzY29wZS5mb3JtRGF0YS5yb29tRGV0YWlscy5zZWxlY3RlZHJvb21zLmxlbmd0aDtcclxuICAkc2NvcGUuc3VtbWFyeS5ub0d1ZXN0PSAkc2NvcGUuZm9ybURhdGEucm9vbURldGFpbHMucXVlcnJ5LmFkdWx0czsgXHJcbiAgJHNjb3BlLnN1bW1hcnkuc3RhcnRkYXRlPSRzY29wZS5mb3JtRGF0YS5yb29tRGV0YWlscy5xdWVycnkuY2hlY2tfaW47XHJcbiAgJHNjb3BlLnN1bW1hcnkuZW5kZGF0ZT0kc2NvcGUuZm9ybURhdGEucm9vbURldGFpbHMucXVlcnJ5LmNoZWNrX291dDtcclxuXHJcbiAgJHNjb3BlLnRvdGFscHJpY2U9ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgdHByaWNlPTA7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgZm9yICh2YXIgaT0wICA7aTwkc2NvcGUuc3VtbWFyeS5ub1Jvb21zO2krKyl7XHJcblxyXG4gICAgICAgICAgIHRwcmljZT10cHJpY2UrJHNjb3BlLmZvcm1EYXRhLnJvb21EZXRhaWxzLnNlbGVjdGVkcm9vbXNbaV0ucm9vbS5iYXNlX3ByaWNlO1xyXG4gICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cHJpY2U7XHJcbiAgICAgIH07XHJcblxyXG5cclxuXHJcbiRzY29wZS5zdW1tYXJ5LnRQcmljZT0gJHNjb3BlLnRvdGFscHJpY2UoKTsgXHJcblxyXG4gICAgXHJcbiAgICAvLyBmdW5jdGlvbiB0byBwcm9jZXNzIHRoZSBmb3JtXHJcbiAgICAkc2NvcGUucHJvY2Vzc0Zvcm0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgIC8vIGFsZXJ0KCdhd2Vzb21lIScpO1xyXG5cclxuICAgICAgICAgIFJlc2VydmF0aW9uU2VydmljZS5jcmVhdGUoJHNjb3BlLmZvcm1EYXRhKVxyXG4gICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcImRhdGEgc2F2ZWQgUmVzZXJ2YXRpb24gSUQgOTg4OVwiKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5mb3JtRGF0YT1cIlwiO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiRXJycm9yIFwiK2Vycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTsgIFxyXG5cclxuXHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAkc2NvcGUucHJvY2VlZD1mdW5jdGlvbigpe1xyXG4gICAgICB2YXIgZGF0YT17fTtcclxuICAgICAgICBkYXRhLnJvb21kZXRhaWxzPSRzY29wZS5mb3JtRGF0YTtcclxuICAgICAgICBkYXRhLnN1bW1hcnk9JHNjb3BlLnN1bW1hcnk7XHJcbiAgICAgICAgIERhdGFTZXJ2aWNlLnNhdmUoZGF0YSk7XHJcbiAgICAgICAgICAgJHN0YXRlLmdvKCdndWVzdGluZm8nKTtcclxuICAgIH07XHJcblxyXG4gICAgXHJcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ1Jlc2VydmVQYXltZW50Q29udHJvbGxlcicsIFsnUmVzZXJ2YXRpb25TZXJ2aWNlJywgZnVuY3Rpb24oUmVzZXJ2YXRpb25TZXJ2aWNlKXtcclxuXHJcbn1dKTsiLCJCb29raW5nLmNvbnRyb2xsZXIoJ2Jvb2tpbmdDb250cm9sbGVyJywgWydSZXNlcnZhdGlvblNlcnZpY2UnLCBmdW5jdGlvbihSZXNlcnZhdGlvblNlcnZpY2Upe1xyXG5cclxufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==